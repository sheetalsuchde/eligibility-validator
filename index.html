<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Eligibility Validator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --brand-blue: #265DDC;
      --brand-blue-hover: #1e4db5;
      --brand-blue-light: #EFF4FF;
      --border-base: #E2E4EB;
      --border-subtle: #F0F2F5;
      --surface-base: #FAFBFC;
      --surface-overlay: #fff;
      --text-primary: #000;
      --text-subtle: #2A2F3D;
      --text-muted: #525252;
      --text-secondary: #3D3D3D;
      --text-success: #027A42;
      --success-bg: #E6FAEE;
      --radius-full: 999px;
      --radius-lg: 12px;
      --radius-md: 8px;
      --radius-sm: 4px;
    }

    html, body { height: 100%; }

    body {
      font-family: 'DM Sans', sans-serif;
      background: var(--surface-base);
      color: var(--text-primary);
      -webkit-font-smoothing: antialiased;
      max-width: 1280px;
      margin-left: auto;
      margin-right: auto;
    }

    /* ───── SCREENS ───── */
    .screen { display: none; min-height: 100vh; flex-direction: column; }
    .screen.active { display: flex; }

    /* ───── HEADER ───── */
    .header {
      background: var(--surface-overlay);
      border-bottom: 1px solid var(--border-base);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 32px;
      position: sticky;
      top: 0;
      z-index: 100;
      flex-shrink: 0;
    }

    .header-left, .header-right {
      display: flex;
      align-items: center;
      gap: 8px;
      flex: 1;
    }
    .header-right { justify-content: flex-end; }

    .header-center {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .header-action-btn {
      display: flex;
      align-items: center;
      gap: 4px;
      background: var(--surface-base);
      border: 1px solid var(--border-base);
      border-radius: var(--radius-lg);
      padding: 4px 12px 4px 8px;
      cursor: pointer;
      font-family: inherit;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-subtle);
      min-height: 32px;
      min-width: 72px;
    }

    .header-action-btn svg { flex-shrink: 0; }

    .logo-container { display: flex; align-items: center; gap: 4px; }
    .logo-mark {
      display: flex;
      align-items: center;
      gap: 3.2px;
      padding-right: 4px;
    }
    .logo-symbol {
      width: 24px;
      height: 24px;
      background: #265DDC;
      border-radius: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .logo-symbol svg { width: 14px; height: 14px; }
    .logo-text {
      font-size: 15px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: -0.3px;
    }
    .logo-dot {
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: var(--border-base);
      flex-shrink: 0;
      margin: 0 4px;
    }
    .partner-logo {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 11px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: 0.5px;
      text-transform: uppercase;
    }
    .partner-icon {
      width: 20px;
      height: 20px;
      background: linear-gradient(135deg, #7B4FE0, #E05FAB);
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* ───── POLICY BADGE ───── */
    .policy-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      background: var(--surface-base);
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      padding: 8px 12px 8px 8px;
      flex-shrink: 0;
    }
    .policy-icon-wrap {
      background: var(--success-bg);
      border-radius: var(--radius-md);
      padding: 2px;
      display: flex;
      align-items: center;
    }
    .policy-text { font-size: 14px; font-weight: 400; color: var(--text-success); white-space: nowrap; }
    .policy-text strong { font-weight: 700; }
    .policy-ext-icon { color: var(--text-success); flex-shrink: 0; }

    /* ───── PAGE HERO (landing) ───── */
    .page-hero {
      padding: 24px 0;
    }
    .page-hero h1 {
      font-size: 20px;
      font-weight: 700;
      line-height: 1.23;
      color: var(--text-primary);
      margin-bottom: 8px;
    }
    .page-hero p {
      font-size: 16px;
      font-weight: 500;
      color: var(--text-subtle);
      line-height: 1.5;
      max-width: 784px;
    }
    .hero-actions {
      display: flex;
      gap: 4px;
      margin-top: 24px;
    }

    /* ───── BUTTONS ───── */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-family: inherit;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      border: none;
      border-radius: var(--radius-full);
      padding: 12px 24px;
      min-height: 48px;
      min-width: 96px;
      transition: background 0.15s, opacity 0.15s;
      text-decoration: none;
    }
    .btn-primary {
      background: var(--brand-blue);
      color: #fff;
    }
    .btn-primary:hover { background: var(--brand-blue-hover); }
    .btn-outline {
      background: transparent;
      color: var(--brand-blue);
      border: 1.5px solid var(--brand-blue);
    }
    .btn-outline:hover { background: var(--brand-blue-light); }
    .btn-ghost {
      background: var(--surface-base);
      color: var(--text-subtle);
      border: 1px solid var(--border-base);
    }
    .btn-ghost:hover { background: #f0f2f5; }

    /* ───── HOW IT WORKS ───── */
    .section-card {
      background: var(--surface-overlay);
      border: 1px solid var(--border-subtle);
      border-radius: 16px;
      padding: 32px;
      margin: 0 auto 24px;
    }
    .section-card-title {
      font-size: 20px;
      font-weight: 700;
      text-align: center;
      margin-bottom: 32px;
      line-height: 1.3;
    }

    .how-it-works-grid {
      display: flex;
      gap: 32px;
    }
    .how-step {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .step-number {
      background: var(--brand-blue-light);
      border-radius: var(--radius-md);
      width: 28px;
      height: 28px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 500;
      color: var(--brand-blue);
      flex-shrink: 0;
    }
    .how-step-title { font-size: 20px; font-weight: 700; line-height: 1.3; }
    .how-step-desc { font-size: 16px; font-weight: 400; color: var(--text-subtle); line-height: 1.5; }

    /* ───── FAQ ───── */
    .faq-section {
      background: var(--surface-overlay);
      border: 1px solid var(--border-subtle);
      border-radius: 14px;
      padding: 30px;
      margin: 0 auto 48px;
    }
    .faq-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 20px;
      line-height: 1.3;
    }
    .faq-item {
      border-bottom: 1px solid #EBEBEB;
      padding: 12px 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
    }
    .faq-item:last-of-type { border-bottom: none; }
    .faq-question { font-size: 20px; font-weight: 500; line-height: 1.5; color: var(--text-primary); }
    .faq-icon {
      flex-shrink: 0;
      width: 24px;
      height: 24px;
      color: var(--text-secondary);
      transition: transform 0.2s;
    }
    .faq-item.open .faq-icon { transform: rotate(180deg); }
    .faq-answer {
      font-size: 15px;
      color: var(--text-subtle);
      line-height: 1.6;
      padding: 0 0 12px;
      display: none;
    }
    .faq-item.open + .faq-answer { display: block; }
    .faq-more {
      display: block;
      text-align: center;
      font-size: 18px;
      font-weight: 500;
      color: var(--brand-blue);
      margin-top: 12px;
      cursor: pointer;
    }

    /* ───── STEP HEADER (active pages) ───── */
    .step-header {
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
      padding: 24px 0;
      gap: 24px;
    }
    .step-title-block h1 {
      font-size: 20px;
      font-weight: 700;
      line-height: 1.23;
      margin-bottom: 4px;
    }
    .step-title-block p {
      font-size: 16px;
      font-weight: 500;
      color: var(--text-subtle);
      line-height: 1.5;
    }

    /* ───── STEPPER ───── */
    .stepper {
      display: flex;
      align-items: stretch;
      margin: 0;
    }
    .stepper-step {
      flex: 1;
      padding: 8px 16px 4px 4px;
      border-top: 2px solid var(--border-base);
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .stepper-step.done { border-top-color: var(--brand-blue); }
    .stepper-step.active { border-top-color: var(--brand-blue); }

    .stepper-base {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    /* Default dot (inactive steps) */
    .stepper-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--border-base);
      flex-shrink: 0;
    }
    .stepper-step.done .stepper-dot { background: var(--brand-blue); }
    .stepper-step.active .stepper-dot { background: var(--brand-blue); }

    /* Blue checkmark circle for completed step */
    .stepper-check {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--brand-blue);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    .stepper-check svg { width: 9px; height: 9px; }

    .stepper-label {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      line-height: 1.4;
    }
    .stepper-step.done .stepper-label { color: var(--brand-blue); }
    .stepper-step.active .stepper-label { color: var(--brand-blue); }
    .stepper-sublabel {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      padding-left: 24px;
      line-height: 1.4;
    }

    /* ───── FORM CONTAINER ───── */
    .form-container {
      background: var(--surface-overlay);
      border: 1px solid var(--border-base);
      border-radius: 16px;
      padding: 32px;
      margin: 24px auto 0;
      display: flex;
      flex-direction: column;
      gap: 48px;
    }

    .form-section {
      display: flex;
      gap: 128px;
      align-items: flex-start;
    }
    .form-block {
      width: 384px;
      min-width: 384px;
      flex-shrink: 0;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .form-block-title {
      font-size: 20px;
      font-weight: 700;
      line-height: 1.3;
      color: var(--text-primary);
    }
    .form-block-desc {
      font-size: 16px;
      font-weight: 400;
      color: var(--text-subtle);
      line-height: 1.5;
    }
    .form-right { flex: 1; display: flex; flex-direction: column; gap: 0; }

    /* ───── SELECT ───── */
    .select-wrap { position: relative; }
    .select-label {
      position: absolute;
      top: -9px;
      left: 7px;
      background: var(--surface-overlay);
      padding: 0 4px;
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      z-index: 1;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .select-label .asterisk { color: #b81626; font-size: 10px; }
    .text-input {
      width: 100%;
      background: var(--surface-overlay);
      border: 1px solid var(--border-base);
      border-radius: var(--radius-md);
      padding: 0 12px;
      height: 56px;
      font-family: inherit;
      font-size: 16px;
      font-weight: 400;
      color: var(--text-primary);
      outline: none;
      transition: border-color 0.15s;
    }
    .text-input::placeholder { color: #b0b5c0; }
    .text-input:hover { border-color: var(--brand-blue); }
    .text-input:focus { border-color: var(--brand-blue); box-shadow: 0 0 0 3px rgba(38,93,220,0.1); }
    .select-control {
      width: 100%;
      background: var(--surface-overlay);
      border: 1px solid var(--border-base);
      border-radius: var(--radius-md);
      padding: 8px 12px;
      min-height: 56px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      cursor: pointer;
      transition: border-color 0.15s;
    }
    .select-control:hover { border-color: var(--brand-blue); }
    .select-control.has-value { border-color: var(--border-base); }
    .select-placeholder {
      font-size: 16px;
      font-weight: 400;
      color: var(--text-muted);
      flex: 1;
    }
    .select-value-display {
      font-size: 16px;
      font-weight: 400;
      color: var(--text-primary);
      flex: 1;
    }
    .select-chevron {
      width: 24px;
      height: 24px;
      flex-shrink: 0;
      color: var(--text-secondary);
      transition: transform 0.2s;
    }
    .select-control.open .select-chevron { transform: rotate(180deg); }

    /* Multi-select tags */
    .tags-wrap {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      flex: 1;
    }
    .tag {
      display: flex;
      align-items: center;
      gap: 5px;
      background: #E9E9E9;
      border-radius: var(--radius-sm);
      padding: 4px 8px;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
    }
    .tag-remove {
      cursor: pointer;
      width: 14px;
      height: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #666;
    }
    .tag-remove:hover { color: #333; }

    /* Dropdown menu */
    .dropdown-menu {
      background: var(--surface-overlay);
      border: 1px solid var(--border-base);
      border-radius: var(--radius-md);
      box-shadow: 0 2px 4px rgba(20,20,20,0.08), 0 1px 2px rgba(20,20,20,0.04);
      display: none;
      flex-direction: column;
      gap: 4px;
      padding: 8px;
    }
    .dropdown-menu.open { display: flex; }
    .dropdown-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 6px 12px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      color: var(--text-primary);
      min-height: 36px;
      transition: background 0.1s;
    }
    .dropdown-item:hover { background: var(--brand-blue-light); }
    .dropdown-item.selected { background: var(--brand-blue-light); color: var(--brand-blue); }
    .dropdown-check { width: 18px; height: 18px; color: var(--brand-blue); }
    .dropdown-divider { height: 1px; background: var(--border-base); margin: 4px 0; }

    /* Checkbox multi-select */
    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 12px;
      border-radius: var(--radius-sm);
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      color: var(--text-primary);
      transition: background 0.1s;
    }
    .checkbox-item:hover { background: var(--brand-blue-light); }
    .checkbox-item input[type="checkbox"] {
      width: 16px;
      height: 16px;
      accent-color: var(--brand-blue);
      cursor: pointer;
      flex-shrink: 0;
    }

    /* ───── BUTTON GROUP ───── */
    .btn-group {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 12px;
      padding: 24px 0;
      margin-top: auto;
    }

    /* ───── DRY RUN SCREEN ───── */
    /* ── Review & Run a Test ── */
    .review-container {
      background: var(--surface-base);
      border-radius: var(--radius-lg);
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .review-name-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      min-height: 32px;
    }
    .review-benefit-label {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-muted);
      margin-right: 10px;
      white-space: nowrap;
    }
    .review-edit-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 5px;
      color: var(--text-muted);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      transition: color 0.15s, background 0.15s;
    }
    .review-edit-btn:hover { color: var(--brand-blue); background: var(--brand-blue-light); }
    .review-name-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--surface-base);
      border: 1px solid var(--border-base);
      border-radius: var(--radius-md);
      padding: 4px 14px;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      min-height: 32px;
    }
    /* ── Configuration Summary panel (Review screen) ── */
    .config-summary-panel {
      background: var(--surface-base);
      border-radius: var(--radius-lg);
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .config-summary-card {
      background: var(--surface-overlay);
      border-radius: var(--radius-md);
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .config-summary-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
      line-height: 1.57;
    }
    .config-summary-row {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 16px;
    }
    .config-summary-key {
      font-size: 16px;
      font-weight: 500;
      color: var(--text-primary);
      line-height: 1.4;
      white-space: nowrap;
      flex-shrink: 0;
    }
    .config-summary-value {
      font-size: 16px;
      font-weight: 500;
      color: var(--text-primary);
      line-height: 1.5;
      text-align: right;
    }
    .config-summary-value.bold {
      font-weight: 600;
    }
    .config-summary-name-wrap {
      display: flex;
      align-items: center;
      gap: 6px;
      justify-content: flex-end;
    }
    .review-rule-card {
      background: var(--brand-blue-light);
      border-radius: var(--radius-md);
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .review-rule-label {
      font-size: 12px;
      font-weight: 700;
      color: var(--text-primary);
      letter-spacing: 0.04em;
      text-transform: uppercase;
    }
    .review-rule-text {
      font-size: 16px;
      font-weight: 400;
      color: var(--text-primary);
      line-height: 1.5;
    }

    /* ── Dry Run In Progress screen ── */
    @keyframes spin { to { transform: rotate(360deg); } }
    .dry-run-spinner {
      width: 32px;
      height: 32px;
      animation: spin 1s linear infinite;
      flex-shrink: 0;
    }
    .dry-run-summary-panel {
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      width: 100%;
    }
    .dry-run-summary-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--text-primary);
    }
    .dry-run-summary-meta {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }
    .dry-run-initiated-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: var(--brand-blue-light);
      color: var(--brand-blue);
      border-radius: var(--radius-full);
      padding: 4px 12px;
      font-size: 13px;
      font-weight: 600;
    }
    .dry-run-initiated-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--brand-blue);
      flex-shrink: 0;
    }
    .dry-run-initiated-time {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .dry-run-info {
      background: var(--surface-overlay);
      border: 1px solid var(--border-base);
      border-radius: 16px;
      padding: 32px;
      margin: 24px auto 0;
    }
    .dry-run-info h2 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px;
    }
    .dry-run-info p {
      font-size: 14px;
      color: var(--text-subtle);
      line-height: 1.5;
      margin-bottom: 24px;
    }
    .dry-run-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    .dry-run-card {
      background: var(--surface-base);
      border: 1px solid var(--border-subtle);
      border-radius: 12px;
      padding: 20px;
    }
    .dry-run-card-label {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 6px;
    }
    .dry-run-card-value {
      font-size: 28px;
      font-weight: 700;
      color: var(--text-primary);
    }
    .dry-run-card-sub {
      font-size: 13px;
      color: var(--text-subtle);
      margin-top: 4px;
    }
    .dry-run-card.warning .dry-run-card-value { color: #C27400; }
    .dry-run-card.danger .dry-run-card-value { color: #b81626; }
    .dry-run-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      font-weight: 500;
      padding: 4px 10px;
      border-radius: var(--radius-full);
      margin-bottom: 8px;
    }
    .dry-run-badge.success { background: var(--success-bg); color: var(--text-success); }
    .dry-run-badge.warning { background: #FFF7E6; color: #C27400; }
    .download-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--surface-overlay);
      border: 1px solid var(--border-base);
      border-radius: var(--radius-full);
      padding: 10px 20px;
      font-family: inherit;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      margin-top: 20px;
      color: var(--text-subtle);
      transition: background 0.15s;
    }
    .download-btn:hover { background: var(--surface-base); }

    /* ── Dry Run Complete screen ── */
    .drc-seal {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      flex-shrink: 0;
    }
    /* CSV download card — green bg, no border */
    .drc-download-card {
      background: var(--success-bg);
      border-radius: var(--radius-md);
      padding: 8px 12px;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      flex-wrap: wrap;
    }
    .drc-download-card-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .drc-file-icon {
      width: 32px;
      height: 32px;
      position: relative;
      flex-shrink: 0;
    }
    .drc-file-icon svg.drc-file-doc {
      width: 100%;
      height: 100%;
    }
    .drc-csv-badge {
      position: absolute;
      bottom: 0px;
      left: 0px;
      background: #17B26A;
      border-radius: 2px;
      padding: 1.5px 2.5px;
      font-family: 'DM Sans', sans-serif;
      font-size: 7px;
      font-weight: 700;
      color: #fff;
      line-height: 1;
      letter-spacing: 0.2px;
    }
    .drc-file-info { min-width: 0; }
    .drc-file-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.57;
    }
    .drc-file-size {
      font-size: 14px;
      font-weight: 400;
      color: var(--text-muted);
      line-height: 1.5;
    }
    .drc-download-btn {
      flex-shrink: 0;
      font-size: 14px;
      padding: 10px 20px;
      min-height: 40px;
    }
    /* Config Summary panel — subtle border */
    .drc-summary-panel {
      border: 1px solid var(--border-subtle);
      border-radius: var(--radius-lg);
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      width: 100%;
    }
    .drc-summary-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--text-primary);
    }
    .drc-summary-inner {
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding: 12px;
    }
    .drc-summary-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
    }
    .drc-summary-key {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      line-height: 1.4;
      white-space: nowrap;
    }
    .drc-summary-value {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      line-height: 1.57;
      text-align: right;
    }
    .drc-status-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: var(--success-bg);
      color: var(--text-success);
      border-radius: var(--radius-sm);
      padding: 2px 8px;
      font-size: 12px;
      font-weight: 500;
    }
    .drc-status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--text-success);
      flex-shrink: 0;
    }
    /* Rule cards inside drc — blue bg matching review screen */
    .drc-rule-card {
      background: var(--brand-blue-light);
      border-radius: var(--radius-md);
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .drc-rule-label {
      font-size: 12px;
      font-weight: 700;
      color: var(--text-primary);
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }
    .drc-rule-text {
      font-size: 16px;
      font-weight: 400;
      color: var(--text-primary);
      line-height: 1.5;
    }

    /* ───── ACTIVATION / CONFIRMATION SCREEN ───── */
    .confirm-card {
      background: var(--surface-overlay);
      border: 1px solid var(--border-base);
      border-radius: 16px;
      padding: 32px;
      margin: 24px auto 0;
      display: flex;
      flex-direction: column;
      gap: 32px;
    }
    .confirm-section-title {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 12px;
    }
    .confirm-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid var(--border-subtle);
      font-size: 15px;
    }
    .confirm-row:last-child { border-bottom: none; }
    .confirm-row-label { font-weight: 500; color: var(--text-subtle); }
    .confirm-row-value { font-weight: 600; color: var(--text-primary); }
    .confirm-active-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: var(--success-bg);
      color: var(--text-success);
      font-size: 13px;
      font-weight: 600;
      padding: 4px 12px;
      border-radius: var(--radius-full);
    }
    .confirm-active-dot {
      width: 7px;
      height: 7px;
      border-radius: 50%;
      background: var(--text-success);
    }
    .helper-box {
      display: flex;
      gap: 10px;
      background: #FFFBEB;
      border: 1px solid #F59E0B;
      border-radius: var(--radius-md);
      padding: 14px 16px;
      font-size: 14px;
      color: #92400E;
      line-height: 1.5;
    }

    /* ───── SUCCESS SCREEN ───── */
    .success-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 80px 48px;
      text-align: center;
      flex: 1;
    }
    .success-icon-circle {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: var(--success-bg);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 24px;
    }
    .success-screen h2 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 12px;
    }
    .success-screen p {
      font-size: 16px;
      color: var(--text-subtle);
      max-width: 480px;
      line-height: 1.6;
      margin-bottom: 32px;
    }

    /* ───── EXISTING VALIDATORS LIST (landing variation) ───── */
    .validators-table {
      margin: 0 auto 48px;
      background: var(--surface-overlay);
      border: 1px solid var(--border-base);
      border-radius: 14px;
      overflow: hidden;
    }
    .validators-table-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px 24px;
      border-bottom: 1px solid var(--border-subtle);
    }
    .validators-table-title {
      font-size: 20px;
      font-weight: 700;
    }
    .table { width: 100%; border-collapse: collapse; }
    .table th {
      text-align: left;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 10px 24px;
      border-bottom: 1px solid var(--border-subtle);
      background: var(--surface-base);
    }
    .table td {
      padding: 14px 24px;
      font-size: 15px;
      border-bottom: 1px solid var(--border-subtle);
    }
    .table tr:last-child td { border-bottom: none; }
    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      font-weight: 600;
      padding: 4px 10px;
      border-radius: var(--radius-full);
    }
    .status-badge.active-badge { background: var(--success-bg); color: var(--text-success); }
    .status-badge.draft-badge { background: #F0F2F5; color: #555; }
    .status-dot { width: 6px; height: 6px; border-radius: 50%; background: currentColor; }

    /* ───── EXISTING VALIDATORS SCREEN ───── */
    .ev-screen {
      display: flex;
      flex-direction: column;
      flex: 1;
      background: var(--surface-base);
    }
    .ev-body {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .ev-page-title {
      font-size: 26px;
      font-weight: 700;
      color: var(--text-primary);
      line-height: 1.2;
      padding: 48px 32px 24px;
    }
    .ev-table-section {
      padding: 0 32px 24px;
      flex: 1;
    }
    .ev-table {
      width: 100%;
      border-collapse: collapse;
    }
    .ev-table thead tr {
      border-bottom: 1px solid var(--border-base);
    }
    .ev-table th {
      text-align: left;
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
      padding: 8px 0;
      line-height: 1.3;
    }
    .ev-table tbody tr {
      border-bottom: 1px solid var(--border-base);
    }
    .ev-table tbody tr:last-child {
      border-bottom: none;
    }
    .ev-table td {
      padding: 12px 0;
      font-size: 16px;
      font-weight: 400;
      color: var(--text-primary);
      line-height: 1.5;
      vertical-align: middle;
    }
    .ev-table td.ev-col-benefit {
      max-width: 268px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .ev-col-gap {
      padding-right: 32px !important;
    }
    .ev-dry-run-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 4px 12px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      /* default — overridden by modifier classes below */
      background: var(--brand-blue-light);
      color: var(--brand-blue);
    }
    /* Initiated → Blue */
    .ev-dry-run-badge.initiated {
      background: #EFF4FF;
      color: #265DDC;
    }
    /* In Progress → Orange */
    .ev-dry-run-badge.in-progress {
      background: #FFF4EB;
      color: #C25700;
    }
    /* Completed → Green */
    .ev-dry-run-badge.completed {
      background: var(--success-bg);
      color: var(--text-success);
    }
    .ev-status-light {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 4px 12px 4px 8px;
      font-size: 14px;
      font-weight: 500;
      color: #676d7a;
    }
    /* Active validator status → Green text */
    .ev-status-light.active { color: var(--text-success); }
    .ev-status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #676d7a;
      flex-shrink: 0;
    }
    .ev-status-dot.active { background: #027A42; }
    .ev-action-btn {
      background: var(--surface-base);
      border: 1px solid var(--border-base);
      border-radius: 12px;
      padding: 4px 12px 4px 8px;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      font-size: 14px;
      font-weight: 500;
      color: #2a2f3d;
      cursor: pointer;
    }
    .ev-action-btn:hover { background: #f0f2f5; }
    .ev-pagination {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 16px;
      padding: 12px 0 0;
    }
    .ev-pagination-label {
      font-size: 12px;
      font-weight: 400;
      color: #2a2f3d;
      line-height: 1.3;
    }
    .ev-pagination-count {
      font-size: 12px;
      font-weight: 400;
      color: var(--text-primary);
    }
    .ev-pagination-rows {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 12px;
    }
    .ev-pagination-arrows {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .ev-arrow-btn {
      background: none;
      border: none;
      cursor: pointer;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      border-radius: 4px;
    }
    .ev-arrow-btn:hover { background: #f0f2f5; }
    /* Footer */
    .ev-footer {
      flex-shrink: 0;
    }
    .ev-footer-main {
      background: #181d29;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 32px;
    }
    .ev-footer-contact {
      display: flex;
      align-items: center;
      gap: 24px;
    }
    .ev-footer-contact-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .ev-footer-icon-wrap {
      background: white;
      border-radius: 12px;
      padding: 3px;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      flex-shrink: 0;
    }
    .ev-footer-text {
      font-size: 12px;
      font-weight: 400;
      color: white;
      white-space: nowrap;
      line-height: 1.5;
    }
    .ev-footer-social {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .ev-footer-legal {
      display: flex;
      align-items: center;
      gap: 24px;
    }
    .ev-footer-legal-link {
      font-size: 12px;
      font-weight: 400;
      color: white;
      white-space: nowrap;
      line-height: 1.5;
      cursor: pointer;
    }
    .ev-footer-sub {
      background: #2a2f3d;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 32px;
    }
    .ev-footer-logo {
      display: flex;
      align-items: center;
      gap: 3.2px;
    }
    .ev-footer-logo-symbol {
      width: 18px;
      height: 18px;
      background: var(--brand-blue);
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .ev-footer-logo-text {
      font-size: 14px;
      font-weight: 500;
      color: white;
    }
    .ev-footer-copyright {
      font-size: 12px;
      font-weight: 400;
      color: white;
      line-height: 1.5;
    }

    /* ───── NOTIFICATIONS / ALERTS ───── */
    .alert {
      display: flex;
      gap: 10px;
      padding: 12px 16px;
      border-radius: var(--radius-md);
      font-size: 14px;
      line-height: 1.5;
      margin: 0 48px;
    }
    .alert-info { background: #EFF4FF; color: var(--brand-blue); border: 1px solid #C7D7FA; }
    .alert svg { flex-shrink: 0; margin-top: 1px; }

    /* ───── RULE SECTION ───── */
    /* Two-card layout: benefit card + eligibility-vars card (separate) */
    .form-card {
      background: var(--surface-overlay);
      border: 1px solid var(--border-base);
      border-radius: 16px;
      padding: 32px;
      margin: 24px auto 0;
      display: flex;
      flex-direction: column;
      gap: 0;
    }
    /* The vars card stacks below the benefit card with its own margin */
    .form-card + .form-card { margin-top: 16px; }

    /* Rule block container inside the vars card — no extra top margin, gap between rule cards */
    .rules-area {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .rule-card {
      background: var(--surface-base);
      border-radius: var(--radius-lg);
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      /* animate in */
      animation: slideDown 0.2s ease;
    }
    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-6px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .rule-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .rule-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--surface-base);
      border: 1px solid var(--border-base);
      border-radius: var(--radius-md);
      padding: 4px 12px 4px 8px;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-primary);
      min-height: 32px;
    }
    .rule-badge-icon {
      width: 20px;
      height: 20px;
      color: var(--text-secondary);
      flex-shrink: 0;
    }
    .rule-header-left {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
      min-width: 0;
    }
    .rule-header-right {
      display: flex;
      align-items: center;
      gap: 4px;
      flex-shrink: 0;
    }
    .rule-collapse-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px;
      color: var(--text-secondary);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      transition: color 0.15s, background 0.15s;
    }
    .rule-collapse-btn:hover { color: var(--brand-blue); background: var(--brand-blue-light); }
    .rule-collapsed-summary {
      font-size: 13px;
      color: var(--text-muted);
    }
    .rule-delete-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px;
      color: var(--text-secondary);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      transition: color 0.15s, background 0.15s;
    }
    .rule-delete-btn:hover { color: #b81626; background: #fff0f0; }

    /* IF label */
    .rule-if-label {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
    }

    /* IF condition box (white inner card — sized to content) */
    .rule-condition-box {
      background: var(--surface-overlay);
      border-radius: var(--radius-md);
      padding: 12px;
      display: inline-flex;
      flex-direction: column;
      gap: 10px;
      align-self: flex-start; /* don't stretch to full row width */
    }
    .rule-condition-variable {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 16px;
      font-weight: 400;
      color: var(--text-primary);
    }
    .rule-condition-variable input[type="checkbox"] {
      width: 16px;
      height: 16px;
      accent-color: var(--brand-blue);
      cursor: default;
      flex-shrink: 0;
    }

    /* Small inline select inside rule */
    .rule-select-wrap {
      position: relative;
      display: inline-block; /* shrink-wraps to select width so caret stays inside */
    }
    .rule-select {
      appearance: none;
      -webkit-appearance: none;
      background: var(--surface-overlay);
      border: 1px solid var(--border-base);
      border-radius: var(--radius-md);
      padding: 10px 36px 10px 12px; /* right pad leaves room for caret */
      font-family: inherit;
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
      cursor: pointer;
      min-height: 44px;
      min-width: 180px;
      width: 100%;
      transition: border-color 0.15s;
    }
    .rule-select:focus { outline: none; border-color: var(--brand-blue); }
    .rule-select.placeholder-shown, .rule-select:has(option[value=""]:checked) { color: var(--text-muted); }
    .rule-select-caret {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
      color: var(--text-secondary);
      z-index: 1;
    }
    .rule-select-label {
      position: absolute;
      top: -8px;
      left: 8px;
      background: var(--surface-overlay);
      padding: 0 4px;
      font-size: 11px;
      font-weight: 500;
      color: var(--text-secondary);
      z-index: 1;
    }

    /* THEN section */
    .rule-then-area {
      background: var(--surface-base);
      border-radius: var(--radius-md);
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .rule-then-label {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      margin-bottom: 4px;
    }
    .rule-then-inner {
      background: var(--surface-overlay);
      border-radius: var(--radius-md);
      padding: 12px;
      display: inline-flex;
      flex-direction: column;
      gap: 10px;
      align-self: flex-start; /* shrink to content width */
    }

    /* Toggle button group (Flat / Tiers) */
    .toggle-group {
      display: inline-flex;
      border: 1px solid var(--border-base);
      border-radius: var(--radius-md);
      overflow: hidden;
    }
    .toggle-btn {
      background: var(--surface-overlay);
      border: none;
      border-right: 1px solid var(--border-base);
      padding: 10px 20px;
      font-family: inherit;
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
      cursor: pointer;
      min-height: 44px;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: background 0.12s;
    }
    .toggle-btn:last-child { border-right: none; }
    .toggle-btn.active {
      background: var(--brand-blue-light);
      color: var(--brand-blue);
    }
    .toggle-check {
      width: 14px;
      height: 14px;
      color: var(--brand-blue);
    }

    /* "Provide repayment of …" row */
    .rule-then-row {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .rule-then-row span {
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
      white-space: nowrap;
    }

    /* Amount free-text input */
    .rule-amount-wrap {
      position: relative;
      display: inline-flex;
      align-items: center;
    }
    .rule-amount-prefix {
      position: absolute;
      left: 12px;
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
      pointer-events: none;
      z-index: 1;
    }
    .rule-amount-input {
      appearance: none;
      -webkit-appearance: none;
      background: var(--surface-overlay);
      border: 1px solid var(--border-base);
      border-radius: var(--radius-md);
      padding: 10px 12px 10px 26px;
      font-family: inherit;
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
      min-height: 44px;
      width: 130px;
      transition: border-color 0.15s;
    }
    .rule-amount-input:focus {
      outline: none;
      border-color: var(--brand-blue);
    }
    .rule-amount-input::-webkit-inner-spin-button,
    .rule-amount-input::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    .rule-amount-input[type=number] { -moz-appearance: textfield; }

    /* ── Multi-condition blocks inside IF box ── */
    .condition-block {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .condition-block-inner {
      display: flex;
      align-items: flex-start;
      gap: 8px;
    }
    .condition-fields-row {
      display: flex;
      flex-wrap: wrap;
      align-items: flex-end;
      gap: 10px;
      flex: 1;
    }

    /* ×  button to remove an individual condition */
    .cond-delete-btn {
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px;
      color: var(--text-secondary);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      margin-top: 12px;   /* optical alignment with inputs */
      flex-shrink: 0;
      transition: color 0.15s, background 0.15s;
    }
    .cond-delete-btn:hover { color: #b81626; background: #fff0f0; }

    /* AND / OR connector row */
    .connector-row {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 4px 0;
    }
    .connector-pill {
      font-family: inherit;
      font-size: 11px;
      font-weight: 700;
      letter-spacing: 0.6px;
      border-radius: var(--radius-full);
      padding: 4px 12px;
      border: 1.5px solid;
      cursor: pointer;
      flex-shrink: 0;
      transition: background 0.15s, color 0.15s;
    }
    .connector-and {
      background: #EFF4FF;
      color: var(--brand-blue);
      border-color: var(--brand-blue);
    }
    .connector-and:hover { background: #dce8ff; }
    .connector-or {
      background: #FFF7E6;
      color: #C27400;
      border-color: #C27400;
    }
    .connector-or:hover { background: #ffefc5; }
    .connector-line {
      flex: 1;
      height: 1px;
      background: var(--border-base);
    }

    /* "+ Add condition" link-style button */
    .add-condition-btn {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      background: none;
      border: none;
      cursor: pointer;
      font-family: inherit;
      font-size: 13px;
      font-weight: 500;
      color: var(--brand-blue);
      padding: 6px 0 2px;
      transition: opacity 0.15s;
    }
    .add-condition-btn:hover { opacity: 0.75; }
    .add-condition-btn svg { flex-shrink: 0; }

    /* Compound row (operator + number + duration) */
    .rule-compound-row {
      display: flex;
      align-items: flex-end;
      gap: 10px;
      flex-wrap: wrap;
    }
    .rule-number-wrap {
      position: relative;
    }
    .rule-number-input {
      appearance: none;
      -webkit-appearance: none;
      background: var(--surface-overlay);
      border: 1px solid var(--border-base);
      border-radius: var(--radius-md);
      padding: 10px 12px;
      font-family: inherit;
      font-size: 15px;
      font-weight: 500;
      color: var(--text-primary);
      min-height: 44px;
      width: 100px;
      transition: border-color 0.15s;
    }
    .rule-number-input:focus { outline: none; border-color: var(--brand-blue); }
    .rule-number-input::-webkit-inner-spin-button,
    .rule-number-input::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
    .rule-number-input[type=number] { -moz-appearance: textfield; }

    /* Rule summary pill */
    .rule-summary {
      background: var(--brand-blue-light);
      border-radius: var(--radius-md);
      padding: 10px 12px;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .rule-summary-label {
      font-size: 11px;
      font-weight: 700;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .rule-summary-text {
      font-size: 15px;
      font-weight: 400;
      color: var(--text-primary);
      line-height: 1.5;
    }

    /* Add another Rule button */
    .add-rule-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: var(--surface-base);
      border: 1px solid var(--border-base);
      border-radius: var(--radius-lg);
      padding: 4px 12px 4px 8px;
      font-family: inherit;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-subtle);
      cursor: pointer;
      min-height: 32px;
      transition: background 0.15s;
      margin-top: 4px;
    }
    .add-rule-btn:hover { background: #eef1f7; }
    .add-rule-btn svg { flex-shrink: 0; }

    /* ───── MISC HELPERS ───── */
    .spacer { flex: 1; }
    .mt-auto { margin-top: auto; }

    /* ── Inner content: fills outer body with 48px side gutters ── */
    .page-hero,
    .step-header,
    .stepper,
    .form-card,
    .form-container,
    .section-card,
    .faq-section,
    .confirm-card,
    .dry-run-info,
    .validators-table,
    .btn-group {
      margin-left: 48px;
      margin-right: 48px;
    }

    @media (max-width: 900px) {
      .form-section { flex-direction: column; gap: 24px; }
      .form-block { width: 100%; min-width: unset; }
      .how-it-works-grid { flex-direction: column; }
      .header { padding: 12px 16px; }
      .page-hero, .step-header { padding: 20px 20px; }
      .section-card, .faq-section, .form-container, .dry-run-info, .confirm-card { margin-left: 20px; margin-right: 20px; }
      .stepper { margin: 0 20px; }
      .btn-group { padding: 20px 20px; }
    }
  </style>
</head>
<body>

<!-- ═══════════════════════════════════════════════════════════════
     SHARED HEADER (rendered once per screen via JS)
═══════════════════════════════════════════════════════════════════ -->

<!-- ═══════════════════════════ SCREEN 0: LANDING ═══════════════════════════ -->
<div class="screen active" id="screen-landing">
  <!-- header -->
  <header class="header">
    <div class="header-left">
      <button class="header-action-btn">
        <svg width="16" height="14" viewBox="0 0 16 14" fill="none"><rect y="0" width="16" height="2" rx="1" fill="currentColor"/><rect y="6" width="16" height="2" rx="1" fill="currentColor"/><rect y="12" width="16" height="2" rx="1" fill="currentColor"/></svg>
        Menu
      </button>
    </div>
    <div class="header-center logo-container">
      <div class="logo-mark">
        <div class="logo-symbol">
          <svg viewBox="0 0 14 14" fill="none"><path d="M7 1L13 4.5V10L7 13.5L1 10V4.5L7 1Z" fill="white" opacity="0.9"/></svg>
        </div>
        <span class="logo-text">candidly</span>
      </div>
      <div class="logo-dot"></div>
      <div class="partner-logo">
        <div class="partner-icon">
          <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6 1L10.33 3.5V8.5L6 11L1.67 8.5V3.5L6 1Z" fill="white"/></svg>
        </div>
        <span>TechValue</span>
      </div>
    </div>
    <div class="header-right">
      <button class="header-action-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
      </button>
      <button class="header-action-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="4"/><path d="M20 21a8 8 0 1 0-16 0"/></svg>
      </button>
    </div>
  </header>

  <!-- hero -->
  <div class="page-hero">
    <h1>Automate Benefit Eligibility with Ease</h1>
    <p>Configure automated eligibility checks for your team in just a few steps. Before you begin, make sure your census file is uploaded in <strong>Employees</strong> so you can validate benefits accurately and seamlessly.</p>
    <div class="hero-actions">
      <button class="btn btn-primary" onclick="navigate('screen-step1')">Create a New Validator</button>
      <button class="btn btn-ghost" onclick="showValidatorsList()">View Existing Validators</button>
    </div>
  </div>

  <!-- How Validation Works -->
  <div class="section-card">
    <div class="section-card-title">How Validation Works</div>
    <div class="how-it-works-grid">
      <div class="how-step">
        <div class="step-number">1</div>
        <div>
          <div class="how-step-title">Configure Validator</div>
          <div class="how-step-desc">Define eligibility rules and conditions</div>
        </div>
      </div>
      <div class="how-step">
        <div class="step-number">2</div>
        <div>
          <div class="how-step-title">Test with Dry Run</div>
          <div class="how-step-desc">Download the report to review flagged records before going live.</div>
        </div>
      </div>
      <div class="how-step">
        <div class="step-number">3</div>
        <div>
          <div class="how-step-title">Activate Validator</div>
          <div class="how-step-desc">Once satisfied with test results, activate the validator.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- FAQ -->
  <div class="faq-section">
    <div class="faq-title">Frequently asked questions</div>

    <div class="faq-item" onclick="toggleFaq(this)">
      <span class="faq-question">What happens when a user activates a new validator?</span>
      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </div>
    <div class="faq-answer">When a new validator is activated, it immediately begins applying eligibility rules to new and existing employee records according to the configured schedule. Any existing in-flight validations complete under the old rules before switching.</div>

    <div class="faq-item" onclick="toggleFaq(this)">
      <span class="faq-question">What exactly does a dry run do?</span>
      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </div>
    <div class="faq-answer">A dry run simulates your eligibility rules against your current employee census without making any changes. It produces a downloadable report of which employees would be flagged so you can review before going live.</div>

    <div class="faq-item" onclick="toggleFaq(this)">
      <span class="faq-question">Is the dry run synchronous or asynchronous?</span>
      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </div>
    <div class="faq-answer">Dry runs are asynchronous. You'll receive a notification and can download the report from your dashboard once processing completes — typically within a few minutes for most organizations.</div>

    <div class="faq-item" onclick="toggleFaq(this)">
      <span class="faq-question">What happens to in-flight validations during activation?</span>
      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </div>
    <div class="faq-answer">In-flight validations that started before activation will complete under the previous rules. New validations triggered after activation will use the updated eligibility configuration.</div>

    <div class="faq-item" onclick="toggleFaq(this)">
      <span class="faq-question">Can I have multiple validators active at once?</span>
      <svg class="faq-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </div>
    <div class="faq-answer">Yes, you can configure separate validators for different benefit products. Each runs independently with its own eligibility rules and schedule.</div>

    <a class="faq-more">View more FAQ's</a>
  </div>
</div>


<!-- ═══════════════════════════ SCREEN 1: CONFIGURE & SAVE ═══════════════════════════ -->
<div class="screen" id="screen-step1">
  <header class="header">
    <div class="header-left">
      <button class="header-action-btn">
        <svg width="16" height="14" viewBox="0 0 16 14" fill="none"><rect y="0" width="16" height="2" rx="1" fill="currentColor"/><rect y="6" width="16" height="2" rx="1" fill="currentColor"/><rect y="12" width="16" height="2" rx="1" fill="currentColor"/></svg>
        Menu
      </button>
    </div>
    <div class="header-center logo-container">
      <div class="logo-mark">
        <div class="logo-symbol">
          <svg viewBox="0 0 14 14" fill="none"><path d="M7 1L13 4.5V10L7 13.5L1 10V4.5L7 1Z" fill="white" opacity="0.9"/></svg>
        </div>
        <span class="logo-text">candidly</span>
      </div>
      <div class="logo-dot"></div>
      <div class="partner-logo">
        <div class="partner-icon">
          <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6 1L10.33 3.5V8.5L6 11L1.67 8.5V3.5L6 1Z" fill="white"/></svg>
        </div>
        <span>TechValue</span>
      </div>
    </div>
    <div class="header-right">
      <button class="header-action-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
      </button>
      <button class="header-action-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="4"/><path d="M20 21a8 8 0 1 0-16 0"/></svg>
      </button>
    </div>
  </header>

  <div class="step-header">
    <div class="step-title-block">
      <h1>Eligibility Validator</h1>
      <p>Automate eligibility checks and benefit calculations across employee programs</p>
    </div>
    <div class="policy-badge">
      <div class="policy-icon-wrap">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 2L3.5 4.5V10C3.5 13.5 6.25 16.75 10 17.5C13.75 16.75 16.5 13.5 16.5 10V4.5L10 2ZM8.5 13L5.5 10L6.91 8.59L8.5 10.17L13.09 5.58L14.5 7L8.5 13Z" fill="#027A42"/><circle cx="12" cy="13" r="2.5" fill="#027A42" opacity="0.3"/><path d="M11 12.5L12 13.5L14 11.5" stroke="#027A42" stroke-width="1.2" stroke-linecap="round"/></svg>
      </div>
      <span class="policy-text">Your data is protected by our <strong>security policy</strong></span>
      <svg class="policy-ext-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
    </div>
  </div>

  <!-- Stepper: 4 steps, Step 1 done (checkmark), Step 2 active (blue), Steps 3-4 inactive -->
  <div class="stepper">
    <div class="stepper-step active">
      <div class="stepper-base">
        <div class="stepper-dot"></div>
        <span class="stepper-label">Configure &amp; Save</span>
      </div>
      <span class="stepper-sublabel">Step 1 of 3</span>
    </div>
    <div class="stepper-step">
      <div class="stepper-base">
        <div class="stepper-dot"></div>
        <span class="stepper-label">Review &amp; Confirm</span>
      </div>
      <span class="stepper-sublabel">Step 2 of 3</span>
    </div>
    <div class="stepper-step">
      <div class="stepper-base">
        <div class="stepper-dot"></div>
        <span class="stepper-label">Set Validator</span>
      </div>
      <span class="stepper-sublabel">Step 3 of 3</span>
    </div>
  </div>

  <!-- Card 1: Benefit / Product — two-column layout -->
  <div class="form-card">
    <div class="form-section">
      <div class="form-block">
        <div class="form-block-title">Start with a Benefit or Product</div>
        <div class="form-block-desc">Choose the benefit or product you want to configure eligibility rules for</div>
      </div>
      <div class="form-right">
        <div class="select-wrap" id="benefit-select-wrap">
          <div class="select-label">Select Benefit <span class="asterisk">✱</span></div>
          <div class="select-control" id="benefit-control" onclick="toggleDropdown('benefit')">
            <span class="select-placeholder" id="benefit-placeholder">Select Benefit</span>
            <span class="select-value-display" id="benefit-value" style="display:none"></span>
            <svg class="select-chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
          </div>
          <div class="dropdown-menu" id="benefit-dropdown">
            <div class="dropdown-item" onclick="selectBenefit('Student Loan Employer Contribution')">Student Loan Employer Contribution</div>
            <div class="dropdown-item" onclick="selectBenefit('529 College Savings Plan')">529 College Savings Plan</div>
            <div class="dropdown-item" onclick="selectBenefit('Health Savings Account (HSA)')">Health Savings Account (HSA)</div>
            <div class="dropdown-item" onclick="selectBenefit('Dependent Care FSA')">Dependent Care FSA</div>
            <div class="dropdown-divider"></div>
            <div class="dropdown-item" onclick="selectBenefit('Other Benefit')">Other Benefit</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Card 2: Validator Name -->
  <div class="form-card" id="validator-name-card" style="display:none;">
    <div class="form-section">
      <div class="form-block">
        <div class="form-block-title">Validator Name</div>
        <div class="form-block-desc">Give this validator a unique name so it's easy to identify later.</div>
      </div>
      <div class="form-right">
        <div class="select-wrap">
          <div class="select-label">Validator Name <span class="asterisk">✱</span></div>
          <input
            type="text"
            id="validator-name-input"
            class="text-input"
            placeholder="e.g. Student Loan — Full Time Employees"
            oninput="validatorName = this.value"
          />
        </div>
      </div>
    </div>
  </div>

  <!-- Card 2: Eligibility Variables — rule editor (hidden until benefit selected) -->
  <div class="form-card" id="eligibility-card" style="gap:32px; display:none;">
    <div class="form-block">
      <div class="form-block-title">Eligibility Variables</div>
      <div class="form-block-desc">Define conditions and repayment amounts for this benefit.</div>
    </div>

    <!-- Rule cards rendered below, full-width inside the card -->
    <div id="rules-area" class="rules-area"></div>
  </div>

  <div class="btn-group">
    <button class="btn btn-outline" onclick="navigate('screen-landing')">Back</button>
    <button class="btn btn-primary" onclick="goToStep2()">Save Configuration</button>
  </div>
</div>


<!-- ═══════════════════════════ SCREEN 2: DRY RUN ═══════════════════════════ -->
<div class="screen" id="screen-step2">
  <header class="header">
    <div class="header-left">
      <button class="header-action-btn">
        <svg width="16" height="14" viewBox="0 0 16 14" fill="none"><rect y="0" width="16" height="2" rx="1" fill="currentColor"/><rect y="6" width="16" height="2" rx="1" fill="currentColor"/><rect y="12" width="16" height="2" rx="1" fill="currentColor"/></svg>
        Menu
      </button>
    </div>
    <div class="header-center logo-container">
      <div class="logo-mark">
        <div class="logo-symbol">
          <svg viewBox="0 0 14 14" fill="none"><path d="M7 1L13 4.5V10L7 13.5L1 10V4.5L7 1Z" fill="white" opacity="0.9"/></svg>
        </div>
        <span class="logo-text">candidly</span>
      </div>
      <div class="logo-dot"></div>
      <div class="partner-logo">
        <div class="partner-icon">
          <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6 1L10.33 3.5V8.5L6 11L1.67 8.5V3.5L6 1Z" fill="white"/></svg>
        </div>
        <span>TechValue</span>
      </div>
    </div>
    <div class="header-right">
      <button class="header-action-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
      </button>
      <button class="header-action-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="4"/><path d="M20 21a8 8 0 1 0-16 0"/></svg>
      </button>
    </div>
  </header>

  <div class="step-header">
    <div class="step-title-block">
      <h1>Eligibility Validator</h1>
      <p>Automate eligibility checks and benefit calculations across employee programs</p>
    </div>
    <div class="policy-badge">
      <div class="policy-icon-wrap">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 2L3.5 4.5V10C3.5 13.5 6.25 16.75 10 17.5C13.75 16.75 16.5 13.5 16.5 10V4.5L10 2ZM8.5 13L5.5 10L6.91 8.59L8.5 10.17L13.09 5.58L14.5 7L8.5 13Z" fill="#027A42"/></svg>
      </div>
      <span class="policy-text">Your data is protected by our <strong>security policy</strong></span>
      <svg class="policy-ext-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
    </div>
  </div>

  <!-- Stepper -->
  <div class="stepper">
    <div class="stepper-step done">
      <div class="stepper-base">
        <div class="stepper-check">
          <svg viewBox="0 0 10 8" fill="none"><path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>
        <span class="stepper-label" style="color: var(--brand-blue);">Configure &amp; Save</span>
      </div>
      <span class="stepper-sublabel">Completed</span>
    </div>
    <div class="stepper-step active">
      <div class="stepper-base">
        <div class="stepper-dot"></div>
        <span class="stepper-label">Review &amp; Confirm</span>
      </div>
      <span class="stepper-sublabel">Step 2 of 3</span>
    </div>
    <div class="stepper-step">
      <div class="stepper-base">
        <div class="stepper-dot"></div>
        <span class="stepper-label">Set Validator</span>
      </div>
      <span class="stepper-sublabel">Step 3 of 3</span>
    </div>
  </div>

  <!-- Review & Run a Test -->
  <div class="form-card" style="gap:24px;">
    <!-- Section heading -->
    <div>
      <div class="form-block-title" style="font-size:20px;">Review &amp; run a test</div>
      <div class="form-block-desc" style="margin-top:4px; max-width:800px;">Your rules are configured and saved. Review the summary and test them now to confirm the outcomes align with your expectations.</div>
    </div>

    <!-- Configuration Summary panel -->
    <div class="config-summary-panel">

      <!-- White summary card: title + key-value rows -->
      <div class="config-summary-card">
        <div class="config-summary-title">Configuration Summary</div>

        <!-- Benefit / Product row -->
        <div class="config-summary-row">
          <span class="config-summary-key">Benefit / Product</span>
          <span class="config-summary-value" id="review-benefit-name">—</span>
        </div>

        <!-- Validator Name row — view mode -->
        <div class="config-summary-row" id="review-name-view-row">
          <span class="config-summary-key">Validator Name</span>
          <div class="config-summary-name-wrap">
            <span class="config-summary-value" id="review-validator-name">—</span>
            <button class="review-edit-btn" onclick="startEditValidatorName()" title="Edit validator name">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- Validator Name — edit mode (hidden by default) -->
        <div class="config-summary-row" id="review-name-edit-row" style="display:none;">
          <span class="config-summary-key">Validator Name</span>
          <div style="display:flex; align-items:center; gap:6px; flex:1; justify-content:flex-end;">
            <input type="text" id="review-name-input" class="text-input" style="height:34px; font-size:14px; flex:1; max-width:320px;"
              placeholder="e.g. Student Loan — Full Time Employees"
              oninput="validatorName = this.value" />
            <button class="btn btn-primary" style="height:34px; padding:0 14px; font-size:13px; white-space:nowrap;" onclick="saveValidatorName()">Save</button>
            <button class="review-edit-btn" onclick="cancelEditValidatorName()" title="Cancel">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- Rule count row -->
        <div class="config-summary-row">
          <span class="config-summary-key">Rule</span>
          <span class="config-summary-value bold" id="review-rule-count">—</span>
        </div>
      </div>

      <!-- Blue rule summary cards -->
      <div id="review-rules-list"></div>
    </div>
  </div>

  <div class="btn-group">
    <button class="btn btn-outline" onclick="navigate('screen-step1')">Back</button>
    <button class="btn btn-primary" onclick="startDryRun()">
      Dry Run
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left:6px"><circle cx="12" cy="12" r="10"/><polygon points="10 8 16 12 10 16 10 8" fill="currentColor" stroke="none"/></svg>
    </button>
  </div>
</div>


<!-- ═══════════════════════ SCREEN 2B: DRY RUN IN PROGRESS ═══════════════════════ -->
<div class="screen" id="screen-dry-run">
  <header class="header">
    <div class="header-left">
      <button class="header-action-btn">
        <svg width="16" height="14" viewBox="0 0 16 14" fill="none"><rect y="0" width="16" height="2" rx="1" fill="currentColor"/><rect y="6" width="16" height="2" rx="1" fill="currentColor"/><rect y="12" width="16" height="2" rx="1" fill="currentColor"/></svg>
        Menu
      </button>
    </div>
    <div class="header-center logo-container">
      <div class="logo-mark">
        <div class="logo-symbol">
          <svg viewBox="0 0 14 14" fill="none"><path d="M7 1L13 4.5V10L7 13.5L1 10V4.5L7 1Z" fill="white" opacity="0.9"/></svg>
        </div>
        <span class="logo-text">candidly</span>
      </div>
      <div class="logo-dot"></div>
      <div class="partner-logo">
        <div class="partner-icon">
          <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6 1L10.33 3.5V8.5L6 11L1.67 8.5V3.5L6 1Z" fill="white"/></svg>
        </div>
        <span>TechValue</span>
      </div>
    </div>
    <div class="header-right">
      <button class="header-action-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
      </button>
      <button class="header-action-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="4"/><path d="M20 21a8 8 0 1 0-16 0"/></svg>
      </button>
    </div>
  </header>

  <div class="step-header">
    <div class="step-title-block">
      <h1>Eligibility Validator</h1>
      <p>Automate eligibility checks and benefit calculations across employee programs</p>
    </div>
    <div class="policy-badge">
      <div class="policy-icon-wrap">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 2L3.5 4.5V10C3.5 13.5 6.25 16.75 10 17.5C13.75 16.75 16.5 13.5 16.5 10V4.5L10 2ZM8.5 13L5.5 10L6.91 8.59L8.5 10.17L13.09 5.58L14.5 7L8.5 13Z" fill="#027A42"/></svg>
      </div>
      <span class="policy-text">Your data is protected by our <strong>security policy</strong></span>
      <svg class="policy-ext-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
    </div>
  </div>

  <!-- Stepper: step 1 done, step 2 active -->
  <div class="stepper">
    <div class="stepper-step done">
      <div class="stepper-base">
        <div class="stepper-check">
          <svg viewBox="0 0 10 8" fill="none"><path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>
        <span class="stepper-label" style="color: var(--brand-blue);">Configure &amp; Save</span>
      </div>
      <span class="stepper-sublabel">Completed</span>
    </div>
    <div class="stepper-step active">
      <div class="stepper-base">
        <div class="stepper-dot"></div>
        <span class="stepper-label">Review &amp; Confirm</span>
      </div>
      <span class="stepper-sublabel">Step 2 of 3</span>
    </div>
    <div class="stepper-step">
      <div class="stepper-base">
        <div class="stepper-dot"></div>
        <span class="stepper-label">Set Validator</span>
      </div>
      <span class="stepper-sublabel">Step 3 of 3</span>
    </div>
  </div>

  <!-- Dry Run in Progress card -->
  <div class="form-card" style="gap:24px;">

    <!-- Spinner -->
    <div class="dry-run-spinner">
      <svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
        <circle cx="16" cy="16" r="13" stroke="#E2E4EB" stroke-width="3"/>
        <path d="M16 3C16 3 27 5 29 16" stroke="#265DDC" stroke-width="3" stroke-linecap="round"/>
      </svg>
    </div>

    <!-- Heading -->
    <div>
      <div class="form-block-title" style="font-size:20px;">Dry Run in Progress</div>
      <div class="form-block-desc" style="margin-top:4px;">We're currently running a test to validate your rules. This typically takes 4–5 hours. Once it's complete, we'll send you an email notification so you can return and download the results.</div>
    </div>

    <!-- Configuration Summary panel -->
    <div class="dry-run-summary-panel">
      <div class="dry-run-summary-title">Configuration Summary</div>

      <!-- Benefit + Name badge + Dry Run Initiated pill + timestamp -->
      <div class="dry-run-summary-meta">
        <div class="review-name-badge" id="dryrun-benefit-name">—</div>
        <div class="review-name-badge" id="dryrun-validator-name">—</div>
        <div class="dry-run-initiated-pill">
          <span class="dry-run-initiated-dot"></span>
          Dry Run Initiated
        </div>
        <span class="dry-run-initiated-time" id="dryrun-initiated-time">—</span>
      </div>

      <!-- Rule cards -->
      <div id="dryrun-rules-list"></div>
    </div>
  </div>

  <!-- Buttons: Back to Configuration (left) | Set Validator disabled (right) -->
  <div class="btn-group" style="justify-content:space-between;">
    <button class="btn btn-outline" onclick="navigate('screen-step2')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:6px"><polyline points="15 18 9 12 15 6"/></svg>
      Back to Configuration
    </button>
    <button class="btn btn-primary" disabled style="opacity:0.45; cursor:not-allowed;">
      Set Validator
    </button>
  </div>
</div>


<!-- ═══════════════════════ SCREEN 2C: DRY RUN COMPLETE ═══════════════════════ -->
<div class="screen" id="screen-dry-run-complete">
  <header class="header">
    <div class="header-left">
      <button class="header-action-btn">
        <svg width="16" height="14" viewBox="0 0 16 14" fill="none"><rect y="0" width="16" height="2" rx="1" fill="currentColor"/><rect y="6" width="16" height="2" rx="1" fill="currentColor"/><rect y="12" width="16" height="2" rx="1" fill="currentColor"/></svg>
        Menu
      </button>
    </div>
    <div class="header-center logo-container">
      <div class="logo-mark">
        <div class="logo-symbol">
          <svg viewBox="0 0 14 14" fill="none"><path d="M7 1L13 4.5V10L7 13.5L1 10V4.5L7 1Z" fill="white" opacity="0.9"/></svg>
        </div>
        <span class="logo-text">candidly</span>
      </div>
      <div class="logo-dot"></div>
      <div class="partner-logo">
        <div class="partner-icon">
          <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6 1L10.33 3.5V8.5L6 11L1.67 8.5V3.5L6 1Z" fill="white"/></svg>
        </div>
        <span>TechValue</span>
      </div>
    </div>
    <div class="header-right">
      <button class="header-action-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
      </button>
      <button class="header-action-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="4"/><path d="M20 21a8 8 0 1 0-16 0"/></svg>
      </button>
    </div>
  </header>

  <div class="step-header">
    <div class="step-title-block">
      <h1>Eligibility Validator</h1>
      <p>Automate eligibility checks and benefit calculations across employee programs</p>
    </div>
    <div class="policy-badge">
      <div class="policy-icon-wrap">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 2L3.5 4.5V10C3.5 13.5 6.25 16.75 10 17.5C13.75 16.75 16.5 13.5 16.5 10V4.5L10 2ZM8.5 13L5.5 10L6.91 8.59L8.5 10.17L13.09 5.58L14.5 7L8.5 13Z" fill="#027A42"/></svg>
      </div>
      <span class="policy-text">Your data is protected by our <strong>security policy</strong></span>
      <svg class="policy-ext-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
    </div>
  </div>

  <!-- Stepper: step 1 done, step 2 active (still in review phase) -->
  <div class="stepper">
    <div class="stepper-step done">
      <div class="stepper-base">
        <div class="stepper-check">
          <svg viewBox="0 0 10 8" fill="none"><path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>
        <span class="stepper-label" style="color: var(--brand-blue);">Configure &amp; Save</span>
      </div>
      <span class="stepper-sublabel">Completed</span>
    </div>
    <div class="stepper-step active">
      <div class="stepper-base">
        <div class="stepper-dot"></div>
        <span class="stepper-label">Review &amp; Confirm</span>
      </div>
      <span class="stepper-sublabel">Step 2 of 3</span>
    </div>
    <div class="stepper-step">
      <div class="stepper-base">
        <div class="stepper-dot"></div>
        <span class="stepper-label">Set Validator</span>
      </div>
      <span class="stepper-sublabel">Step 3 of 3</span>
    </div>
  </div>

  <!-- Dry Run Complete card -->
  <div class="form-card" style="gap:24px;">

    <!-- Icon + heading + description stacked vertically -->
    <div style="display:flex; flex-direction:column; gap:4px;">
      <!-- Seal check icon -->
      <div class="drc-seal" style="margin-bottom:20px;">
        <div style="border: 1px solid var(--border-subtle, #F0F2F5); border-radius: 10px; padding: 6px; display:flex; align-items:center; justify-content:center; background:#fff;">
          <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M16 2L19.09 5.26L23.5 4.27L24.74 8.66L29 10.18L27.74 14.5L30.5 17.91L27.74 21.32L29 25.64L24.74 27.16L23.5 31.55L19.09 30.56L16 33.82L12.91 30.56L8.5 31.55L7.26 27.16L3 25.64L4.26 21.32L1.5 17.91L4.26 14.5L3 10.18L7.26 8.66L8.5 4.27L12.91 5.26L16 2Z" fill="#17B26A"/>
            <path d="M10.5 16.5L14 20L21.5 12" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
      </div>
      <div class="form-block-title" style="font-size:20px; font-weight:700;">Dry Run Complete. Ready for review</div>
      <div class="form-block-desc" style="margin-top:4px; max-width:800px;">Before activating the validator, you must download and review the results CSV. Confirm that the file reflects your entire employee population — all names, IDs, and benefit details.</div>
    </div>

    <!-- CSV Download card: green bg, file icon + name/size, outline button -->
    <div class="drc-download-card">
      <div class="drc-download-card-left">
        <div class="drc-file-icon">
          <svg class="drc-file-doc" viewBox="0 0 44 48" fill="none" xmlns="http://www.w3.org/2000/svg">
            <rect x="2" y="2" width="34" height="44" rx="3" fill="white" stroke="#D0D5DD" stroke-width="1.5"/>
            <path d="M24 2 L36 14 L24 14 Z" fill="#E4E7EC" stroke="#D0D5DD" stroke-width="1.5" stroke-linejoin="round"/>
            <path d="M24 2 L24 14 L36 14" fill="none" stroke="#D0D5DD" stroke-width="1.5"/>
            <line x1="8" y1="22" x2="28" y2="22" stroke="#E4E7EC" stroke-width="2" stroke-linecap="round"/>
            <line x1="8" y1="28" x2="28" y2="28" stroke="#E4E7EC" stroke-width="2" stroke-linecap="round"/>
            <line x1="8" y1="34" x2="20" y2="34" stroke="#E4E7EC" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <span class="drc-csv-badge">CSV</span>
        </div>
        <div class="drc-file-info">
          <div class="drc-file-name">Repayment Validator.CSV</div>
          <div class="drc-file-size">2.15KB</div>
        </div>
      </div>
      <button class="btn btn-outline drc-download-btn" onclick="alert('CSV download started!')">
        Download CSV
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left:4px"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
      </button>
    </div>

    <!-- Configuration Summary panel — subtle border, key-value table -->
    <div class="drc-summary-panel">
      <div class="drc-summary-title">Configuration Summary</div>
      <div class="drc-summary-inner">

        <!-- Benefit / Product -->
        <div class="drc-summary-row">
          <span class="drc-summary-key">Benefit / Product</span>
          <span class="drc-summary-value" id="drc-benefit-name">—</span>
        </div>

        <!-- Validator Name -->
        <div class="drc-summary-row">
          <span class="drc-summary-key">Validator Name</span>
          <span class="drc-summary-value" id="drc-validator-name">—</span>
        </div>

        <!-- Status -->
        <div class="drc-summary-row">
          <span class="drc-summary-key">Status</span>
          <span class="drc-status-pill">
            <span class="drc-status-dot"></span>
            Dry Run Completed
          </span>
        </div>

        <!-- Date -->
        <div class="drc-summary-row">
          <span class="drc-summary-key">Date</span>
          <span class="drc-summary-value" id="drc-completed-time">—</span>
        </div>

        <!-- Rule summary cards -->
        <div id="drc-rules-list"></div>
      </div>
    </div>
  </div>

  <!-- Buttons: Back to Configuration (left) | Set Validator ENABLED (right) -->
  <div class="btn-group" style="justify-content:space-between;">
    <button class="btn btn-outline" onclick="navigate('screen-step2')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right:6px"><polyline points="15 18 9 12 15 6"/></svg>
      Back to Configuration
    </button>
    <button class="btn btn-primary" onclick="showConfirmation(); navigate('screen-step3');">
      Set Validator
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-left:6px"><polyline points="9 18 15 12 9 6"/></svg>
    </button>
  </div>
</div>


<!-- ═══════════════════════════ SCREEN 3: SET VALIDATOR ═══════════════════════════ -->
<div class="screen" id="screen-step3">
  <header class="header">
    <div class="header-left">
      <button class="header-action-btn">
        <svg width="16" height="14" viewBox="0 0 16 14" fill="none"><rect y="0" width="16" height="2" rx="1" fill="currentColor"/><rect y="6" width="16" height="2" rx="1" fill="currentColor"/><rect y="12" width="16" height="2" rx="1" fill="currentColor"/></svg>
        Menu
      </button>
    </div>
    <div class="header-center logo-container">
      <div class="logo-mark">
        <div class="logo-symbol">
          <svg viewBox="0 0 14 14" fill="none"><path d="M7 1L13 4.5V10L7 13.5L1 10V4.5L7 1Z" fill="white" opacity="0.9"/></svg>
        </div>
        <span class="logo-text">candidly</span>
      </div>
      <div class="logo-dot"></div>
      <div class="partner-logo">
        <div class="partner-icon">
          <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6 1L10.33 3.5V8.5L6 11L1.67 8.5V3.5L6 1Z" fill="white"/></svg>
        </div>
        <span>TechValue</span>
      </div>
    </div>
    <div class="header-right">
      <button class="header-action-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
      </button>
      <button class="header-action-btn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="4"/><path d="M20 21a8 8 0 1 0-16 0"/></svg>
      </button>
    </div>
  </header>

  <div class="step-header">
    <div class="step-title-block">
      <h1>Eligibility Validator</h1>
      <p>Automate eligibility checks and benefit calculations across employee programs</p>
    </div>
    <div class="policy-badge">
      <div class="policy-icon-wrap">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 2L3.5 4.5V10C3.5 13.5 6.25 16.75 10 17.5C13.75 16.75 16.5 13.5 16.5 10V4.5L10 2ZM8.5 13L5.5 10L6.91 8.59L8.5 10.17L13.09 5.58L14.5 7L8.5 13Z" fill="#027A42"/></svg>
      </div>
      <span class="policy-text">Your data is protected by our <strong>security policy</strong></span>
      <svg class="policy-ext-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
    </div>
  </div>

  <!-- Stepper -->
  <div class="stepper">
    <div class="stepper-step done">
      <div class="stepper-base">
        <div class="stepper-check">
          <svg viewBox="0 0 10 8" fill="none"><path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>
        <span class="stepper-label" style="color: var(--brand-blue);">Configure &amp; Save</span>
      </div>
      <span class="stepper-sublabel">Completed</span>
    </div>
    <div class="stepper-step done">
      <div class="stepper-base">
        <div class="stepper-check">
          <svg viewBox="0 0 10 8" fill="none"><path d="M1 4L3.5 6.5L9 1" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>
        <span class="stepper-label" style="color: var(--brand-blue);">Review &amp; Confirm</span>
      </div>
      <span class="stepper-sublabel">Completed</span>
    </div>
    <div class="stepper-step active">
      <div class="stepper-base">
        <div class="stepper-dot"></div>
        <span class="stepper-label">Set Validator</span>
      </div>
      <span class="stepper-sublabel">Step 3 of 3</span>
    </div>
  </div>

  <!-- Confirmation Card -->
  <div class="confirm-card">
    <div>
      <div class="confirm-section-title">Validator Summary</div>
      <div class="confirm-row">
        <span class="confirm-row-label">Validator Name</span>
        <span class="confirm-row-value" id="confirm-name">—</span>
      </div>
      <div class="confirm-row">
        <span class="confirm-row-label">Benefit / Product</span>
        <span class="confirm-row-value" id="confirm-benefit">Student Loan Employer Contributions</span>
      </div>
      <div class="confirm-row">
        <span class="confirm-row-label">Eligibility Variables</span>
        <span class="confirm-row-value" id="confirm-vars">Employment Type, Hire date</span>
      </div>
      <div class="confirm-row">
        <span class="confirm-row-label">Dry Run Status</span>
        <span class="confirm-row-value">
          <span class="confirm-active-badge">
            <span class="confirm-active-dot"></span>
            Passed — 1,284 eligible, 78 flagged
          </span>
        </span>
      </div>
      <div class="confirm-row">
        <span class="confirm-row-label">Active Rules</span>
        <span class="confirm-row-value" id="confirm-rule-count">3</span>
      </div>
      <div class="confirm-row">
        <span class="confirm-row-label">Replacing</span>
        <span class="confirm-row-value">Student Loan Repayment Validator 05</span>
      </div>
      <div class="confirm-row">
        <span class="confirm-row-label">Next cycle</span>
        <span class="confirm-row-value">March 01, 2026</span>
      </div>
    </div>
    <div class="helper-box">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" flex-shrink="0" style="flex-shrink:0;margin-top:1px"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
      <div>
        <strong>Activating this validator will replace the current active configuration.</strong><br/>
        In-flight validations will complete under existing rules. New validations will use the updated eligibility settings starting <strong>March 01, 2026</strong>.
      </div>
    </div>
  </div>

  <div class="btn-group">
    <button class="btn btn-ghost" onclick="navigate('screen-step2')">Back</button>
    <button class="btn btn-primary" onclick="activate()">Activate Validator</button>
  </div>
</div>


<!-- ═══════════════════════════ SCREEN 5: EXISTING VALIDATORS ═══════════════════════════ -->
<div class="screen" id="screen-validators">
  <div class="ev-screen">
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <button class="header-action-btn">
          <svg width="16" height="14" viewBox="0 0 16 14" fill="none"><rect y="0" width="16" height="2" rx="1" fill="currentColor"/><rect y="6" width="16" height="2" rx="1" fill="currentColor"/><rect y="12" width="16" height="2" rx="1" fill="currentColor"/></svg>
          Menu
        </button>
      </div>
      <div class="header-center logo-container">
        <div class="logo-mark">
          <div class="logo-symbol">
            <svg viewBox="0 0 14 14" fill="none"><path d="M7 1L13 4.5V10L7 13.5L1 10V4.5L7 1Z" fill="white" opacity="0.9"/></svg>
          </div>
          <span class="logo-text">candidly</span>
        </div>
        <div class="logo-dot"></div>
        <div class="partner-logo">
          <div class="partner-icon">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6 1L10.33 3.5V8.5L6 11L1.67 8.5V3.5L6 1Z" fill="white"/></svg>
          </div>
          <span>TechValue</span>
        </div>
      </div>
      <div class="header-right">
        <button class="header-action-btn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
        </button>
        <button class="header-action-btn">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="4"/><path d="M20 21a8 8 0 1 0-16 0"/></svg>
        </button>
      </div>
    </header>

    <div class="ev-body">
      <!-- Page title -->
      <div class="ev-page-title">Existing Validators</div>

      <!-- Table section -->
      <div class="ev-table-section">
        <table class="ev-table">
          <thead>
            <tr>
              <th class="ev-col-gap">Created Date</th>
              <th class="ev-col-gap">Created By</th>
              <th class="ev-col-gap" style="min-width:175px">Validator Name</th>
              <th class="ev-col-gap" style="min-width:268px">Benefit/Product</th>
              <th class="ev-col-gap">Dry Run Status</th>
              <th class="ev-col-gap">Validator Status</th>
              <th style="width:40px"></th>
            </tr>
          </thead>
          <tbody id="ev-table-body">
            <!-- Populated by renderValidatorsTable() -->
          </tbody>
        </table>

        <!-- Pagination -->
        <div class="ev-pagination">
          <span class="ev-pagination-label">Rows per page:</span>
          <div class="ev-pagination-rows" style="display:flex;align-items:center;gap:2px;">
            <span style="font-size:12px;color:var(--text-primary);">5</span>
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color:#2a2f3d"><polyline points="6 9 12 15 18 9"/></svg>
          </div>
          <span class="ev-pagination-count">1–5 of 24</span>
          <div class="ev-pagination-arrows">
            <button class="ev-arrow-btn" title="Previous page">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
            </button>
            <button class="ev-arrow-btn" title="Next page">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="ev-footer">
        <div class="ev-footer-main">
          <!-- Contact -->
          <div class="ev-footer-contact">
            <div class="ev-footer-contact-item">
              <div class="ev-footer-icon-wrap">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#265DDC" stroke-width="2"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="M2 7l10 7 10-7"/></svg>
              </div>
              <span class="ev-footer-text">help@getcandidly.com</span>
            </div>
            <div class="ev-footer-contact-item">
              <div class="ev-footer-icon-wrap">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#265DDC" stroke-width="2"><path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07A19.5 19.5 0 013.07 11a19.79 19.79 0 01-3.07-8.67A2 2 0 012 .18h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L6.91 7.91a16 16 0 006.16 6.16l1.27-.81a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/></svg>
              </div>
              <span class="ev-footer-text">(866) 719-3437</span>
            </div>
            <span class="ev-footer-text">Get in Touch: Monday to Friday 9am – 8pm EST</span>
          </div>
          <!-- Social icons -->
          <div class="ev-footer-social">
            <div class="ev-footer-icon-wrap">
              <!-- X / Twitter -->
              <svg width="14" height="14" viewBox="0 0 24 24" fill="#181d29"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-4.714-6.231-5.401 6.231H2.744l7.733-8.835L1.254 2.25H8.08l4.253 5.622L18.244 2.25zm-1.161 17.52h1.833L7.084 4.126H5.117L17.083 19.77z"/></svg>
            </div>
            <div class="ev-footer-icon-wrap">
              <!-- LinkedIn -->
              <svg width="14" height="14" viewBox="0 0 24 24" fill="#181d29"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6zM2 9h4v12H2z"/><circle cx="4" cy="4" r="2"/></svg>
            </div>
            <div class="ev-footer-icon-wrap">
              <!-- YouTube -->
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#181d29" stroke-width="2"><rect x="2" y="5" width="20" height="14" rx="3"/><polygon points="10 9 16 12 10 15" fill="#181d29" stroke="none"/></svg>
            </div>
            <div class="ev-footer-icon-wrap">
              <!-- Instagram -->
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#181d29" stroke-width="2"><rect x="2" y="2" width="20" height="20" rx="5"/><circle cx="12" cy="12" r="5"/><circle cx="17.5" cy="6.5" r="1" fill="#181d29"/></svg>
            </div>
          </div>
          <!-- Legal -->
          <div class="ev-footer-legal">
            <span class="ev-footer-legal-link">Security</span>
            <span class="ev-footer-legal-link">Terms of Service</span>
            <span class="ev-footer-legal-link">Privacy policy</span>
          </div>
        </div>
        <div class="ev-footer-sub">
          <div class="ev-footer-logo">
            <div class="ev-footer-logo-symbol">
              <svg viewBox="0 0 14 14" fill="none" width="12" height="12"><path d="M7 1L13 4.5V10L7 13.5L1 10V4.5L7 1Z" fill="white" opacity="0.9"/></svg>
            </div>
            <span class="ev-footer-logo-text" style="margin-left:4px;">candidly</span>
          </div>
          <span class="ev-footer-copyright">Copyright © 2024 Candidly. All rights reserved.</span>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- ═══════════════════════════ SCREEN 4: SUCCESS ═══════════════════════════ -->
<div class="screen" id="screen-success">
  <header class="header">
    <div class="header-left"></div>
    <div class="header-center logo-container">
      <div class="logo-mark">
        <div class="logo-symbol">
          <svg viewBox="0 0 14 14" fill="none"><path d="M7 1L13 4.5V10L7 13.5L1 10V4.5L7 1Z" fill="white" opacity="0.9"/></svg>
        </div>
        <span class="logo-text">candidly</span>
      </div>
      <div class="logo-dot"></div>
      <div class="partner-logo">
        <div class="partner-icon">
          <svg width="12" height="12" viewBox="0 0 12 12" fill="none"><path d="M6 1L10.33 3.5V8.5L6 11L1.67 8.5V3.5L6 1Z" fill="white"/></svg>
        </div>
        <span>TechValue</span>
      </div>
    </div>
    <div class="header-right"></div>
  </header>
  <div class="success-screen">
    <div class="success-icon-circle">
      <svg width="40" height="40" viewBox="0 0 40 40" fill="none"><circle cx="20" cy="20" r="20" fill="#E6FAEE"/><path d="M12 20L17 25L28 14" stroke="#027A42" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
    </div>
    <h2>Validator Activated!</h2>
    <p><strong id="success-name">Your eligibility validator</strong> for <strong id="success-benefit">Student Loan Employer Contributions</strong> is now live. Eligibility checks will begin running on your next cycle — <strong>March 01, 2026</strong>.</p>
    <div style="display:flex;gap:12px;flex-wrap:wrap;justify-content:center">
      <button class="btn btn-outline" onclick="showValidatorsList()">View Existing Validators</button>
      <button class="btn btn-primary" onclick="navigate('screen-step1')">Create a New Validator</button>
    </div>
  </div>
</div>


<script>
  /* ══════════════════════════════════════════════════
     STATE
  ══════════════════════════════════════════════════ */
  let validatorName = '';
  let selectedBenefit = '';
  let benefitDropdownOpen = false;

  /* Independent rule list — each entry is one Rule card */
  let rules = [];           // see VARIABLE_CONFIG for per-rule shape
  let nextRuleId = 1;

  /*
   * VARIABLE_CONFIG — defines how each variable's IF block renders and
   * how its summary sentence is built.
   *
   * type: 'select'   → single dropdown, options[]
   * type: 'compound' → operator dropdown + number input + duration dropdown
   * type: 'multiselect' → checkboxes, options[]
   */
  const VARIABLE_CONFIG = {
    'Employment Type': {
      type: 'select',
      placeholder: 'Select Employment Type',
      options: ['Full time', 'Part time', 'Contract', 'Intern'],
      summary: (r) => {
        const val = r.conditionValue || 'any';
        return `Employees with employment type "${val}"`;
      },
    },
    'Hire date': {
      type: 'compound',
      operatorLabel: 'Condition',
      operators: ['≥ (More than or equal to)', '≤ (Less than or equal to)'],
      operatorShort: { '≥ (More than or equal to)': '≥', '≤ (Less than or equal to)': '≤' },
      numberLabel: 'Number',
      durationLabel: 'Duration',
      durations: ['Days', 'Weeks', 'Months', 'Years'],
      summary: (r) => {
        const op  = r.operator  ? (r.operator.startsWith('≥') ? 'at least' : 'at most') : '—';
        const num = r.number    || '0';
        const dur = r.duration  || 'Days';
        return `Employees hired ${op} ${num} ${dur} ago`;
      },
    },
    'Benefit duration cap': {
      type: 'select',
      placeholder: 'Select duration cap',
      options: ['6 months', '12 months', '24 months', 'Unlimited'],
      summary: (r) => `Benefit duration capped at "${r.conditionValue || 'any'}"`,
    },
    'Lifetime payout cap': {
      type: 'select',
      placeholder: 'Select payout cap',
      options: ['$5,000', '$10,000', '$25,000', 'Unlimited'],
      summary: (r) => `Lifetime payout capped at "${r.conditionValue || 'any'}"`,
    },
    'Hours per week': {
      type: 'compound',
      operatorLabel: 'Condition',
      operators: ['≥ (More than or equal to)', '≤ (Less than or equal to)'],
      operatorShort: { '≥ (More than or equal to)': '≥', '≤ (Less than or equal to)': '≤' },
      numberLabel: 'Hours',
      durationLabel: null,   // no duration unit needed — always "hrs/week"
      durations: [],
      summary: (r) => {
        const op  = r.operator ? (r.operator.startsWith('≥') ? 'at least' : 'at most') : '—';
        const num = r.number || '0';
        return `Employees working ${op} ${num} hours per week`;
      },
    },
    'Location / State': {
      type: 'select',
      placeholder: 'Select state',
      options: ['CA', 'NY', 'TX', 'FL', 'All states'],
      summary: (r) => `Employees located in "${r.conditionValue || 'any state'}"`,
    },
  };

  const ALL_VARIABLE_NAMES = Object.keys(VARIABLE_CONFIG);


  /* ══════════════════════════════════════════════════
     NAVIGATION
  ══════════════════════════════════════════════════ */
  function navigate(screenId) {
    if (screenId === 'screen-step3') showConfirmation();
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(screenId).classList.add('active');
    window.scrollTo(0, 0);
    closeAllDropdowns();
  }

  /* ══════════════════════════════════════════════════
     FAQ
  ══════════════════════════════════════════════════ */
  function toggleFaq(item) { item.classList.toggle('open'); }

  /* ══════════════════════════════════════════════════
     BENEFIT DROPDOWN
  ══════════════════════════════════════════════════ */
  function toggleDropdown(type) {
    if (type === 'benefit') {
      benefitDropdownOpen = !benefitDropdownOpen;
      document.getElementById('benefit-dropdown').classList.toggle('open', benefitDropdownOpen);
      document.getElementById('benefit-control').classList.toggle('open', benefitDropdownOpen);
    }
  }

  function closeDropdown(type) {
    if (type === 'benefit') {
      benefitDropdownOpen = false;
      document.getElementById('benefit-dropdown').classList.remove('open');
      document.getElementById('benefit-control').classList.remove('open');
    }
  }

  function closeAllDropdowns() {
    closeDropdown('benefit');
  }

  function selectBenefit(value) {
    selectedBenefit = value;
    document.getElementById('benefit-placeholder').style.display = 'none';
    const v = document.getElementById('benefit-value');
    v.style.display = 'block';
    v.textContent = value;
    document.getElementById('benefit-control').classList.add('has-value');
    closeDropdown('benefit');
    // Reveal the Validator Name card, then Eligibility Variables card
    document.getElementById('validator-name-card').style.display = 'flex';
    document.getElementById('eligibility-card').style.display = 'flex';
    if (rules.length === 0) addBlankRule();
  }


  /* ══════════════════════════════════════════════════
     RULE MANAGEMENT
     Each rule now has:
       conditions[] — array of condition objects, one per variable
       connector    — 'AND' | 'OR' (shared across all conditions in this rule)
       amountValue  — the THEN repayment amount
  ══════════════════════════════════════════════════ */

  let nextCondId = 1; // separate id counter for conditions

  function blankCondition(varName) {
    return { cid: nextCondId++, varName: varName || '', conditionValue: '', operator: '', number: '', duration: '' };
  }

  function blankRule(varName) {
    return {
      id: nextRuleId++,
      conditions: [ blankCondition(varName || '') ],
      connector: 'AND',
      amountValue: '',
      collapsed: false
    };
  }

  function addBlankRule() {
    rules.push(blankRule(ALL_VARIABLE_NAMES[0]));
    renderRules();
  }

  function deleteRuleById(id) {
    rules = rules.filter(r => r.id !== id);
    renderRules();
  }

  function toggleRuleCollapse(id) {
    const rule = rules.find(r => r.id === id);
    if (!rule) return;
    rule.collapsed = !rule.collapsed;
    renderRules();
  }

  /* Add a new condition block inside an existing rule */
  function addConditionToRule(ruleId) {
    const rule = rules.find(r => r.id === ruleId);
    if (!rule) return;
    rule.conditions.push(blankCondition(''));
    renderRules();
  }

  /* Remove one condition from a rule (min 1 kept) */
  function deleteCondition(ruleId, cid) {
    const rule = rules.find(r => r.id === ruleId);
    if (!rule || rule.conditions.length <= 1) return;
    rule.conditions = rule.conditions.filter(c => c.cid !== cid);
    renderRules();
  }

  /* Swap connector AND ↔ OR */
  function toggleConnector(ruleId) {
    const rule = rules.find(r => r.id === ruleId);
    if (!rule) return;
    rule.connector = rule.connector === 'AND' ? 'OR' : 'AND';
    renderRules();
  }

  /* Change variable on a condition — resets its fields */
  function updateConditionVar(ruleId, cid, varName) {
    const rule = rules.find(r => r.id === ruleId);
    if (!rule) return;
    const cond = rule.conditions.find(c => c.cid === cid);
    if (!cond) return;
    const newCond = blankCondition(varName);
    newCond.cid = cond.cid;
    Object.assign(cond, newCond);
    renderRules();
  }

  /* Field-level updates — update state then refresh summary only */
  function updateConditionValue(ruleId, cid, value) {
    const cond = getCondition(ruleId, cid);
    if (cond) { cond.conditionValue = value; refreshRuleSummaryById(ruleId); }
  }
  function updateConditionOperator(ruleId, cid, value) {
    const cond = getCondition(ruleId, cid);
    if (cond) { cond.operator = value; refreshRuleSummaryById(ruleId); }
  }
  function updateConditionNumber(ruleId, cid, value) {
    const cond = getCondition(ruleId, cid);
    if (cond) { cond.number = value; refreshRuleSummaryById(ruleId); }
  }
  function updateConditionDuration(ruleId, cid, value) {
    const cond = getCondition(ruleId, cid);
    if (cond) { cond.duration = value; refreshRuleSummaryById(ruleId); }
  }
  function updateRuleAmount(ruleId, value) {
    const rule = rules.find(r => r.id === ruleId);
    if (rule) { rule.amountValue = value ? '$' + value : ''; refreshRuleSummaryById(ruleId); }
  }

  function getCondition(ruleId, cid) {
    const rule = rules.find(r => r.id === ruleId);
    return rule ? rule.conditions.find(c => c.cid === cid) : null;
  }

  /* ── Summary builders ── */
  function buildConditionSummary(cond) {
    const cfg = VARIABLE_CONFIG[cond.varName];
    if (!cfg) return '—';
    return cfg.summary(cond);
  }

  function buildRuleSummary(rule) {
    if (!rule.conditions || rule.conditions.length === 0) return '—';
    const parts = rule.conditions.map(buildConditionSummary);
    const joined = parts.join(` ${rule.connector} `);
    const amt = rule.amountValue || '$0';
    return `IF ${joined} → repayment of ${amt} per month`;
  }

  function refreshRuleSummaryById(ruleId) {
    const rule = rules.find(r => r.id === ruleId);
    if (!rule) return;
    const text = buildRuleSummary(rule);
    // Update expanded summary block
    const el = document.getElementById(`rule-summary-${ruleId}`);
    if (el) el.querySelector('.rule-summary-text').textContent = text;
    // Update collapsed inline summary if visible
    const card = document.getElementById(`rule-card-${ruleId}`);
    if (card) {
      const inline = card.querySelector('.rule-collapsed-summary');
      if (inline) inline.textContent = text;
    }
  }

  /* ── IF-block fields for one condition object ── */
  function buildConditionFields(ruleId, cond) {
    const cfg = VARIABLE_CONFIG[cond.varName];
    if (!cfg) return '';
    const cid = cond.cid;

    if (cfg.type === 'select') {
      const opts = ['', ...cfg.options]
        .map(o => o === ''
          ? `<option value="" disabled ${!cond.conditionValue ? 'selected' : ''}>${cfg.placeholder}</option>`
          : `<option value="${o}" ${cond.conditionValue === o ? 'selected' : ''}>${o}</option>`)
        .join('');
      return `
        <div class="rule-select-wrap">
          <span class="rule-select-label">${cond.varName}</span>
          <select class="rule-select" onchange="updateConditionValue(${ruleId},${cid},this.value)">
            ${opts}
          </select>
          <svg class="rule-select-caret" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
        </div>`;
    }

    if (cfg.type === 'compound') {
      const opOpts = ['', ...cfg.operators]
        .map(o => o === ''
          ? `<option value="" disabled ${!cond.operator ? 'selected' : ''}>Choose condition</option>`
          : `<option value="${o}" ${cond.operator === o ? 'selected' : ''}>${o}</option>`)
        .join('');
      const durField = cfg.durations && cfg.durations.length > 0 ? `
        <div class="rule-select-wrap">
          <span class="rule-select-label">${cfg.durationLabel}</span>
          <select class="rule-select" style="min-width:110px" onchange="updateConditionDuration(${ruleId},${cid},this.value)">
            ${cfg.durations.map(d => `<option value="${d}" ${cond.duration === d ? 'selected' : ''}>${d}</option>`).join('')}
          </select>
          <svg class="rule-select-caret" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
        </div>` : '';
      return `
        <div class="rule-compound-row">
          <div class="rule-select-wrap" style="flex:1">
            <span class="rule-select-label">${cfg.operatorLabel}</span>
            <select class="rule-select" style="min-width:200px;width:100%" onchange="updateConditionOperator(${ruleId},${cid},this.value)">
              ${opOpts}
            </select>
            <svg class="rule-select-caret" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
          </div>
          <div class="rule-number-wrap">
            <span class="rule-select-label">${cfg.numberLabel}</span>
            <input type="number" class="rule-number-input" min="0" placeholder="0"
              value="${cond.number || ''}"
              oninput="updateConditionNumber(${ruleId},${cid},this.value)" />
          </div>
          ${durField}
        </div>`;
    }
    return '';
  }

  /* ── Build the full IF block for a rule (all conditions + connectors) ── */
  function buildIfBlock(rule) {
    const ruleId = rule.id;
    let html = '';

    rule.conditions.forEach((cond, idx) => {
      const isLast = idx === rule.conditions.length - 1;
      const canDelete = rule.conditions.length > 1;

      // Variable selector — exclude variables already used by other conditions in this rule
      const usedByOthers = rule.conditions
        .filter(c => c.cid !== cond.cid)
        .map(c => c.varName);
      const varOpts = ALL_VARIABLE_NAMES
        .filter(v => !usedByOthers.includes(v) || v === cond.varName)
        .map(v => `<option value="${v}" ${cond.varName === v ? 'selected' : ''}>${v}</option>`)
        .join('');

      html += `
        <div class="condition-block" id="cond-${cond.cid}">
          <div class="condition-block-inner">
            <div class="condition-fields-row">
              <div class="rule-select-wrap">
                <span class="rule-select-label">Eligibility Variable</span>
                <select class="rule-select" onchange="updateConditionVar(${ruleId},${cond.cid},this.value)">
                  <option value="" disabled ${!cond.varName ? 'selected' : ''}>Select Eligibility Variable</option>
                  ${varOpts}
                </select>
                <svg class="rule-select-caret" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
              </div>
              ${buildConditionFields(ruleId, cond)}
            </div>
            ${canDelete ? `
              <button class="cond-delete-btn" onclick="deleteCondition(${ruleId},${cond.cid})" title="Remove condition">
                <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
              </button>` : ''}
          </div>
        </div>`;

      // Connector pill between conditions (not after the last one)
      if (!isLast) {
        html += `
          <div class="connector-row">
            <button class="connector-pill connector-${rule.connector.toLowerCase()}"
              onclick="toggleConnector(${ruleId})" title="Click to switch AND / OR">
              ${rule.connector}
            </button>
            <div class="connector-line"></div>
          </div>`;
      }
    });

    // "+ Add condition" — only shown if there are still unused variables available
    const usedVars = rule.conditions.map(c => c.varName);
    const hasMore  = ALL_VARIABLE_NAMES.some(v => !usedVars.includes(v));
    if (hasMore) {
      html += `
        <button class="add-condition-btn" onclick="addConditionToRule(${ruleId})">
          <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
            <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
          Add condition
        </button>`;
    }

    return html;
  }

  /* ══════════════════════════════════════════════════
     RULE CARD RENDERING
  ══════════════════════════════════════════════════ */
  function renderRules() {
    const area = document.getElementById('rules-area');
    area.innerHTML = '';

    rules.forEach((rule, idx) => {
      const ruleNum   = idx + 1;
      const id        = rule.id;
      const amountRaw = rule.amountValue ? rule.amountValue.replace(/[^0-9.]/g, '') : '';
      const summaryText = buildRuleSummary(rule);

      const card = document.createElement('div');
      card.className = 'rule-card' + (rule.collapsed ? ' rule-card-collapsed' : '');
      card.id = `rule-card-${id}`;
      card.innerHTML = `
        <div class="rule-header">
          <div class="rule-header-left">
            <div class="rule-badge">
              <svg class="rule-badge-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M9 21V9"/>
              </svg>
              Rule ${ruleNum}
            </div>
            ${rule.collapsed ? `<span class="rule-collapsed-summary">${summaryText}</span>` : ''}
          </div>
          <div class="rule-header-right">
            <button class="rule-collapse-btn" onclick="toggleRuleCollapse(${id})" title="${rule.collapsed ? 'Expand rule' : 'Collapse rule'}">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                style="transform: rotate(${rule.collapsed ? '0deg' : '180deg'}); transition: transform 0.2s;">
                <polyline points="6 9 12 15 18 9"/>
              </svg>
            </button>
            ${rules.length > 1 ? `
            <button class="rule-delete-btn" onclick="deleteRuleById(${id})" title="Remove rule">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8">
                <polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 01-2 2H8a2 2 0 01-2-2L5 6"/>
                <path d="M10 11v6M14 11v6"/><path d="M9 6V4a1 1 0 011-1h4a1 1 0 011 1v2"/>
              </svg>
            </button>` : ''}
          </div>
        </div>

        ${!rule.collapsed ? `
        <div class="rule-if-label">IF (select conditions)</div>

        <div class="rule-condition-box">
          ${buildIfBlock(rule)}
        </div>

        <div class="rule-then-area">
          <div class="rule-then-label">THEN</div>
          <div class="rule-then-inner">
            <div class="rule-then-row">
              <span>Provide repayment of</span>
              <div class="rule-amount-wrap">
                <span class="rule-select-label">Amount</span>
                <span class="rule-amount-prefix">$</span>
                <input type="number" class="rule-amount-input" min="0" placeholder="0"
                  value="${amountRaw}"
                  oninput="updateRuleAmount(${id}, this.value)" />
              </div>
              <span>per month</span>
            </div>
          </div>
        </div>

        <div class="rule-summary" id="rule-summary-${id}">
          <div class="rule-summary-label">Rule ${ruleNum} Summary</div>
          <div class="rule-summary-text">${summaryText}</div>
        </div>
        ` : ''}
      `;
      area.appendChild(card);
    });

    if (rules.length > 0) {
      const addBtn = document.createElement('button');
      addBtn.className = 'add-rule-btn';
      addBtn.innerHTML = `
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
        Add another Rule
      `;
      addBtn.onclick = addBlankRule;
      area.appendChild(addBtn);
    }
  }

  /* ══════════════════════════════════════════════════
     STEP 2: DRY RUN
  ══════════════════════════════════════════════════ */
  function goToStep2() {
    // Populate validator name
    const nameEl = document.getElementById('review-validator-name');
    if (nameEl) nameEl.textContent = validatorName.trim() || 'Unnamed Validator';

    // Populate benefit
    const benefitEl = document.getElementById('review-benefit-name');
    if (benefitEl) benefitEl.textContent = selectedBenefit || '—';

    // Populate rule count
    const countEl = document.getElementById('review-rule-count');
    if (countEl) countEl.textContent = rules.length;

    // Populate rule summary cards
    const listEl = document.getElementById('review-rules-list');
    if (listEl) {
      listEl.innerHTML = rules.map((rule, idx) => {
        const summary = buildRuleSummary(rule);
        return `
          <div class="review-rule-card">
            <div class="review-rule-label">Rule ${idx + 1} Summary</div>
            <div class="review-rule-text">${summary}</div>
          </div>`;
      }).join('');
    }

    navigate('screen-step2');
  }

  /* ── Inline edit for Validator Name on Screen 2 ── */
  function startEditValidatorName() {
    document.getElementById('review-name-view-row').style.display = 'none';
    const editRow = document.getElementById('review-name-edit-row');
    editRow.style.display = 'flex';
    const input = document.getElementById('review-name-input');
    input.value = validatorName;
    input.focus();
    input.select();
  }

  function saveValidatorName() {
    const input = document.getElementById('review-name-input');
    validatorName = input.value.trim();
    // Sync back to Screen 1 input
    const s1Input = document.getElementById('validator-name-input');
    if (s1Input) s1Input.value = validatorName;
    // Update the badge text
    document.getElementById('review-validator-name').textContent = validatorName || 'Unnamed Validator';
    document.getElementById('review-name-edit-row').style.display = 'none';
    document.getElementById('review-name-view-row').style.display = 'flex';
  }

  function cancelEditValidatorName() {
    document.getElementById('review-name-edit-row').style.display = 'none';
    document.getElementById('review-name-view-row').style.display = 'flex';
  }

  // Track any pending dry-run timer so we can cancel if the user navigates away
  let _dryRunTimer = null;

  function startDryRun() {
    // Cancel any previous timer
    if (_dryRunTimer) { clearTimeout(_dryRunTimer); _dryRunTimer = null; }

    const displayName = validatorName.trim() || 'Unnamed Validator';

    // Stamp the initiated time
    const now = new Date();
    const timeStr = now.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' })
      + ' at '
      + now.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit', hour12: true });

    // ── Populate "Dry Run In Progress" screen ──
    const benefitEl = document.getElementById('dryrun-benefit-name');
    if (benefitEl) benefitEl.textContent = selectedBenefit || '—';

    const nameEl = document.getElementById('dryrun-validator-name');
    if (nameEl) nameEl.textContent = displayName;

    const timeEl = document.getElementById('dryrun-initiated-time');
    if (timeEl) timeEl.textContent = timeStr;

    const listEl = document.getElementById('dryrun-rules-list');
    if (listEl) {
      listEl.innerHTML = rules.map((rule, idx) => `
        <div class="review-rule-card">
          <div class="review-rule-label">Rule ${idx + 1} Summary</div>
          <div class="review-rule-text">${buildRuleSummary(rule)}</div>
        </div>`).join('');
    }

    // ── Pre-populate "Dry Run Complete" screen ──
    const drcBenefitEl = document.getElementById('drc-benefit-name');
    if (drcBenefitEl) drcBenefitEl.textContent = selectedBenefit || '—';

    const drcNameEl = document.getElementById('drc-validator-name');
    if (drcNameEl) drcNameEl.textContent = displayName;

    const drcTimeEl = document.getElementById('drc-completed-time');
    if (drcTimeEl) drcTimeEl.textContent = timeStr;

    const drcListEl = document.getElementById('drc-rules-list');
    if (drcListEl) {
      drcListEl.innerHTML = rules.map((rule, idx) => `
        <div class="drc-rule-card">
          <div class="drc-rule-label">Rule ${idx + 1} Summary</div>
          <div class="drc-rule-text">${buildRuleSummary(rule)}</div>
        </div>`).join('');
    }

    navigate('screen-dry-run');

    // After 30 seconds automatically transition to the completed screen
    _dryRunTimer = setTimeout(function() {
      _dryRunTimer = null;
      navigate('screen-dry-run-complete');
    }, 30000);
  }

  /* ══════════════════════════════════════════════════
     STEP 3: CONFIRMATION
  ══════════════════════════════════════════════════ */
  function showConfirmation() {
    document.getElementById('confirm-name').textContent =
      validatorName.trim() || '—';
    document.getElementById('confirm-benefit').textContent =
      selectedBenefit || 'Student Loan Employer Contributions';
    document.getElementById('confirm-rule-count').textContent =
      rules.length || 0;
  }

  /* ══════════════════════════════════════════════════
     ACTIVATE
  ══════════════════════════════════════════════════ */
  function activate() {
    const name = validatorName.trim();
    document.getElementById('success-name').textContent =
      name ? `"${name}"` : 'Your eligibility validator';
    document.getElementById('success-benefit').textContent =
      selectedBenefit || 'Student Loan Employer Contributions';
    navigate('screen-success');
  }

  /* ══════════════════════════════════════════════════
     MISC
  ══════════════════════════════════════════════════ */
  /* ── Sample data for the validators table ── */
  const VALIDATORS_DATA = [
    { date: 'Jan 1, 2026', createdBy: 'John Adams',     name: 'Repayment Validator 04', benefit: 'Student loan Employer Contributions', dryRunStatus: 'Initiated', validatorStatus: 'Draft' },
    { date: 'Jan 1, 2026', createdBy: 'Adam Scott',     name: 'Repayment Validator 03', benefit: 'Student loan Employer Contributions', dryRunStatus: 'Initiated', validatorStatus: 'Draft' },
    { date: 'Jan 1, 2026', createdBy: 'Jennifer Sams',  name: 'Repayment Validator 01', benefit: 'Student loan Employer Contributions', dryRunStatus: 'Initiated', validatorStatus: 'Draft' },
  ];

  function renderValidatorsTable() {
    const tbody = document.getElementById('ev-table-body');
    if (!tbody) return;

    /* Merge the newly-created validator (if any) at the top */
    const freshEntry = validatorName.trim() ? {
      date: new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }),
      createdBy: 'You',
      name: validatorName.trim(),
      benefit: selectedBenefit || '—',
      dryRunStatus: 'Dry Run Completed',
      validatorStatus: 'Active',
    } : null;

    const rows = freshEntry ? [freshEntry, ...VALIDATORS_DATA] : VALIDATORS_DATA;

    tbody.innerHTML = rows.map(r => {
      const isActive = r.validatorStatus === 'Active';

      /* Dry Run badge colour class */
      const dryKey = r.dryRunStatus.toLowerCase();
      let dryClass = 'initiated';
      if (dryKey.includes('progress')) dryClass = 'in-progress';
      else if (dryKey.includes('complet')) dryClass = 'completed';

      return `
        <tr>
          <td class="ev-col-gap">${r.date}</td>
          <td class="ev-col-gap">${r.createdBy}</td>
          <td class="ev-col-gap" style="min-width:175px">${r.name}</td>
          <td class="ev-col-gap ev-col-benefit" style="min-width:268px;max-width:268px" title="${r.benefit}">${r.benefit}</td>
          <td class="ev-col-gap">
            <span class="ev-dry-run-badge ${dryClass}">${r.dryRunStatus}</span>
          </td>
          <td class="ev-col-gap">
            <span class="ev-status-light${isActive ? ' active' : ''}">
              <span class="ev-status-dot${isActive ? ' active' : ''}"></span>
              ${r.validatorStatus}
            </span>
          </td>
          <td>
            <button class="ev-action-btn" title="More actions">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="5" r="1.5"/><circle cx="12" cy="12" r="1.5"/><circle cx="12" cy="19" r="1.5"/></svg>
            </button>
          </td>
        </tr>`;
    }).join('');
  }

  function showValidatorsList() {
    renderValidatorsTable();
    navigate('screen-validators');
  }

  /* ─── Global click-outside to close dropdowns ─── */
  document.addEventListener('click', function(e) {
    const bWrap = document.getElementById('benefit-select-wrap');
    if (benefitDropdownOpen && bWrap && !bWrap.contains(e.target)) closeDropdown('benefit');
  });
</script>
</body>
</html>
